/**
 * State-based routing for AngularJS
 * @version v0.2.15
 * @link http://angular-ui.github.com/
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */


define("appraisals/utils/routes",[],function(){return function(e,t){e.otherwise("/dashboard"),t.state("appraisals",{abstract:!0,template:"<ui-view/>",resolve:{format:["DateFormat",function(e){return e.getDateFormat()}],statuses:["AppraisalCycle",function(e){return e.statuses()}],types:["AppraisalCycle",function(e){return e.types()}]}}).state("appraisals.dashboard",{url:"/dashboard",controller:"AppraisalsDashboardCtrl",controllerAs:"dashboard",templateUrl:CRM.vars.appraisals.baseURL+"/views/dashboard.html",resolve:{activeCycles:["AppraisalCycle",function(e){return e.active()}],totalCycles:["AppraisalCycle",function(e){return e.total()}],statusOverview:["AppraisalCycle",function(e){return e.statusOverview()}]}}).state("appraisals.appraisal-cycle",{abstract:!0,url:"/appraisal-cycle/:cycleId",controller:"AppraisalCycleCtrl",controllerAs:"cycle",templateUrl:CRM.vars.appraisals.baseURL+"/views/appraisal-cycle.html"}).state("appraisals.appraisal-cycle.cycle-summary",{url:"/appraisal-cycle/:cycleId/cycle-summary",templateUrl:CRM.vars.appraisals.baseURL+"/views/appraisal-cycle/cycle-summary.html"}).state("appraisals.appraisal-cycle.appraisals-in-cycle",{url:"/appraisal-cycle/:cycleId/appraisals-in-cycle",templateUrl:CRM.vars.appraisals.baseURL+"/views/appraisal-cycle/appraisals-in-cycle.html"}).state("appraisals.profile",{url:"/profile",templateUrl:CRM.vars.appraisals.baseURL+"/views/profile.html"}).state("appraisals.import",{url:"/import",templateUrl:CRM.vars.appraisals.baseURL+"/views/import.html"})}}),define("appraisals/modules/controllers",["common/angular"],function(e){return e.module("appraisals.controllers",[])}),define("appraisals/controllers/appraisals-ctrl",["appraisals/modules/controllers"],function(e){"use strict";e.controller("AppraisalsCtrl",["$log","$rootElement","$uibModal","AppraisalCycle",function(e,t,r,n){return e.debug("AppraisalsCtrl"),{openAppraisalCycleModal:function(){r.open({appendTo:t.children().eq(0),controller:"AppraisalCycleModalCtrl",controllerAs:"modal",bindToController:!0,templateUrl:CRM.vars.appraisals.baseURL+"/views/modals/appraisal-cycle.html"})}}}])}),define("appraisals/modules/models-instances",["common/angular","common/models/instances/instance"],function(e){"use strict";return e.module("appraisals.models.instances",["common.models.instances"])}),define("appraisals/modules/models",["common/angular","common/modules/models","common/modules/apis","common/mocks/module","appraisals/modules/models-instances"],function(e){"use strict";return e.module("appraisals.models",["common.models","common.apis","common.mocks","appraisals.models.instances"])}),define("appraisals/models/appraisal-cycle",["common/lodash","common/moment","appraisals/modules/models","common/models/model","common/services/api/appraisal-cycle"],function(e,t,r){"use strict";r.factory("AppraisalCycle",["Model","api.appraisal-cycle","AppraisalCycleInstance",function(r,n,a){return r.extend({active:function(){return n.total({cycle_is_active:!0})},all:function(e,t){return n.all(this.processFilters(e),t).then(function(e){return e.list=e.list.map(function(e){return a.init(e,!0)}),e})},create:function(e){var t=a.init(e).toAPI();return n.create(t).then(function(e){return a.init(e,!0)})},find:function(e){return n.find(e).then(function(e){return a.init(e,!0)})},grades:function(){return n.grades()},statuses:function(){return n.statuses().then(function(t){return t.map(function(t){return e.pick(t,["value","label"])})})},statusOverview:function(r){return n.statusOverview(e.defaults(r||{},{current_date:t().format("YYYY-MM-DD")})).then(function(t){return{steps:e.reduce(t,function(e,t){return e[t.status_id]={name:t.status_name,due:t.contacts_count.due,overdue:t.contacts_count.overdue},e},{}),totalAppraisalsNumber:e.reduce(t,function(e,t){return e+t.contacts_count.due+t.contacts_count.overdue},0)}})},total:function(){return n.total()},types:function(){return n.types().then(function(t){return t.map(function(t){return e.pick(t,["value","label"])})})}})}])}),define("appraisals/controllers/appraisals-dashboard-ctrl",["common/angular","common/moment","appraisals/modules/controllers","appraisals/models/appraisal-cycle"],function(e,t,r){"use strict";r.controller("AppraisalsDashboardCtrl",["$filter","$log","$uibModal","$rootElement","$rootScope","$scope","$timeout","AppraisalCycle","activeCycles","HR_settings","totalCycles","statusOverview","statuses","types",function(r,n,a,i,o,l,s,c,u,p,f,d,m,h){function v(){o.$on("AppraisalCycle::new",function(e,t){C.cycles.list.unshift(t)}),o.$on("AppraisalCycle::edit",function(e,t){var r,n;for(r=0,n=C.cycles.list.length;r<n&&C.cycles.list[r].id!==t.id;r++);C.cycles.list.splice(r,1,t)})}function $(){var t=e.copy(C.filters);return null===t.cycle_is_active&&delete t.cycle_is_active,Object.keys(t).filter(function(e){return _.endsWith(e,"_date")||_.endsWith(e,"_due")}).forEach(function(e){t[e].from=r("date")(t[e].from,p.DATE_FORMAT),t[e].to=r("date")(t[e].to,p.DATE_FORMAT)}),t}function y(e){var r=t();return c.statusOverview({cycles_ids:e,start_date:r.startOf("isoWeek").format("YYYY-MM-DD"),end_date:r.endOf("isoWeek").format("YYYY-MM-DD")})}function g(e,t){t?e.list.forEach(function(e){C.cycles.list.push(e)}):C.cycles.list=e.list,C.cycles.total=e.total,C.loading.done=C.cycles.list.length===e.total}function w(e){C.appraisalsWeeklyFigures=_.reduce(e.steps,function(e,t){return e.due+=t.due,e.overdue+=t.overdue,e},{due:0,overdue:0})}function b(){var e=null;l.$watch(function(){return C.filters},function(t,r){t!==r&&(s.cancel(e),e=s(C.requestCycles,500))},!0)}n.debug("AppraisalsDashboardCtrl");var C={};return C.activeFilters=[{label:"active",value:!0},{label:"inactive",value:!1},{label:"all",value:null}],C.appraisalsWeeklyFigures={due:0,overdue:0},C.cycles={list:[],total:0},C.filtersCollapsed=!0,C.filters={cycle_is_active:C.activeFilters[0].value},C.loading={done:!1,inProgress:!1},C.pagination={page:1,size:5},C.activeCycles=u,C.totalCycles=f,C.statusOverview=d,C.statuses=m,C.types=h,C.changeActiveFilter=function(e){void 0!==(e=C.activeFilters.filter(function(t){return t.label===e})[0])&&C.filters.cycle_is_active!==e.value&&(C.filters.cycle_is_active=e.value,C.requestCycles())},C.editCycle=function(e){var t=o.$new();t.cycleId=e,a.open({appendTo:i.children().eq(0),controller:"AppraisalCycleModalCtrl",controllerAs:"modal",bindToController:!0,scope:t,templateUrl:CRM.vars.appraisals.baseURL+"/views/modals/appraisal-cycle.html"})},C.requestCycles=function(e){var t;e&&C.loading.done||(C.loading.inProgress=!0,C.pagination.page=e?C.pagination.page+1:1,c.all($(),C.pagination).then(function(r){return t=r,e?null:y(t.allIds)}).then(function(r){!!r&&w(r),g(t,e)}).then(function(){C.loading.inProgress=!1}))},function(){v(),b(),C.requestCycles()}(),C}])}),define("appraisals/controllers/appraisal-cycle-ctrl",["common/lodash","appraisals/modules/controllers","appraisals/models/appraisal-cycle"],function(e,t){"use strict";t.controller("AppraisalCycleCtrl",["$log","$uibModal","$rootElement","$rootScope","$stateParams","$timeout","AppraisalCycle","dialog","statuses","types",function(t,r,n,a,i,o,l,s,c,u){function p(){a.$on("AppraisalCycle::edit",function(t,r){e.assign(h.cycle,r),f()})}function f(){v=h.cycle.attributes()}function d(t){return r.open(e.assign({appendTo:n.children().eq(0),controller:t.controller,controllerAs:"modal",bindToController:!0,scope:function(t){var r=a.$new();return e.assign(r,t),r}(t.scopeData),windowClass:t.windowClass||null,templateUrl:CRM.vars.appraisals.baseURL+"/views/modals/"+t.templateFile}))}function m(){l.find(i.cycleId).then(function(e){return h.cycle=e,h.loading.cycle=!1,h.cycle.loadAppraisals({overdue:!0})}).then(function(){f(),h.loading.appraisals=!1})}t.debug("AppraisalCycleCtrl");var h={},v={};return h.cycle={},h.filtersCollapsed=!0,h.loading={cycle:!0,appraisals:!0},h.picker={opened:!1},h.statuses=c,h.types=u,h.grades=[{label:"Value #1",value:10},{label:"Value #2",value:20},{label:"Value #3",value:30},{label:"Value #4",value:40}],h.toggleCalendar=function(){o(function(){h.picker.opened=!h.picker.opened})},h.delete=function(){s.open({title:"Confirm Delete Appraisal",copyCancel:"Cancel",copyConfirm:"Delete",classConfirm:"btn-danger-outline",msg:"This cannot be undone"})},h.openAccessSettingsModal=function(){d({controller:"AccessSettingsModalCtrl",templateFile:"access-settings.html"})},h.openAddContactsModal=function(){d({controller:"AddContactsModalCtrl",templateFile:"add-contacts.html",scopeData:{cycleId:h.cycle.id}})},h.openEditDatesModal=function(){d({controller:"EditDatesModalCtrl",templateFile:"edit-dates.html",scopeData:{cycle:h.cycle}})},h.openViewCycleModal=function(){d({controller:"ViewCycleModalCtrl",templateFile:"view-cycle.html"})},h.openSendNotificationReminderModal=function(){d({controller:"SendNotificationReminderModalCtrl",windowClass:"modal--send-notification-reminder",templateFile:"send-notification-reminder.html"})},h.update=function(){s.open({title:"Confirm Cycle Update",copyCancel:null,copyConfirm:"Proceed",msg:"This will update the data of the cycle"}).then(function(t){t?(h.cycle.update(),f()):e.assign(h.cycle,v)})},function(){p(),m()}(),h}])}),define("appraisals/controllers/modals/basic-modal-ctrl",["appraisals/modules/controllers"],function(e){e.controller("BasicModalCtrl",["$log","$uibModalInstance",function(e,t){return e.debug("BasicModalCtrl"),{cancel:function(){t.dismiss("cancel")}}}])}),define("appraisals/controllers/modals/appraisal-cycle-modal-ctrl",["common/lodash","common/moment","appraisals/modules/controllers"],function(e,t,r){"use strict";r.controller("AppraisalCycleModalCtrl",["$filter","$log","$rootScope","$scope","$controller","$uibModalInstance","AppraisalCycle","HR_settings","dialog",function(r,n,a,i,o,l,s,c,u){function p(){s.create($.cycle).then(function(e){a.$emit("AppraisalCycle::new",e),l.close()})}function f(){$.cycle.update().then(function(){a.$emit("AppraisalCycle::edit",$.cycle),l.close()})}function d(){return e($.form).omit(function(t,r){return e.startsWith(r,"$")}).transform(function(t,r,n){return t[n]=e.omit(r.$error,function(e){return!e}),t},{}).omit(function(t){return e.isEmpty(t)}).value()}function m(){return!e.isEqual(y,$.cycle.dueDates())}function h(){var e=t($.cycle.cycle_start_date),r=t($.cycle.cycle_end_date),n=t($.cycle.cycle_self_appraisal_due),a=t($.cycle.cycle_manager_appraisal_due),i=t($.cycle.cycle_grade_due);return $.form.cycle_end_date.$setValidity("isAfter",r.isAfter(e)),$.form.cycle_manager_appraisal_due.$setValidity("isAfter",a.isAfter(n)),$.form.cycle_grade_due.$setValidity("isAfter",i.isAfter(a)),$.form.$valid}function v(){return u.open({title:"Confirm Change Dates",copyCancel:"Cancel",copyConfirm:"Proceed",msg:"This will update the due dates for all appraisals in the cycle"})}n.debug("AppraisalCycleModalCtrl");var $=Object.create(o("BasicModalCtrl",{$uibModalInstance:l})),y={};return $.cycle={},$.types=[],$.edit=!1,$.formErrors={},$.formSubmitted=!1,$.loaded={types:!1,cycle:!i.cycleId},$.submit=function(){if($.formSubmitted=!0,!h())return void($.formErrors=d());$.edit?m()?v().then(function(e){!!e&&f()}):f():p()},function(){s.types().then(function(e){$.types=e,$.loaded.types=!0}),i.cycleId&&($.edit=!0,s.find(i.cycleId).then(function(e){y=e.dueDates(),$.cycle=e,$.loaded.cycle=!0}))}(),$}])}),define("appraisals/controllers/modals/access-settings-modal-ctrl",["appraisals/modules/controllers"],function(e){"use strict";e.controller("AccessSettingsModalCtrl",["$log","$controller","$uibModalInstance",function(e,t,r){return e.debug("AccessSettingsModalCtrl"),Object.create(t("BasicModalCtrl",{$uibModalInstance:r}))}])}),define("appraisals/controllers/modals/edit-dates-modal-ctrl",["common/angular","appraisals/modules/controllers"],function(e,t){"use strict";t.controller("EditDatesModalCtrl",["$filter","$log","$rootScope","$scope","$controller","$uibModalInstance","HR_settings","dialog",function(t,r,n,a,i,o,l,s){function c(){return _(d.form).omit(function(e,t){return _.startsWith(t,"$")}).transform(function(e,t,r){return e[r]=_.omit(t.$error,function(e){return!e}),e},{}).omit(function(e){return _.isEmpty(e)}).value()}function u(){return!_.isEqual(m,d.cycle.dueDates())}function p(){return s.open({title:"Confirm Change Dates",copyCancel:"Cancel",copyConfirm:"Proceed",msg:"This will update the due dates for all appraisals in the cycle"})}function f(){d.cycle.update().then(function(){n.$emit("AppraisalCycle::edit",d.cycle),o.close()})}r.debug("EditDatesModalCtrl");var d=Object.create(i("BasicModalCtrl",{$uibModalInstance:o})),m={};return d.cycle=e.copy(a.cycle),d.formErrors={},d.formSubmitted=!1,d.submit=function(){if(d.formSubmitted=!0,!d.form.$valid)return void(d.formErrors=c());u()?p().then(function(e){!!e&&f()}):f()},function(){m=d.cycle.dueDates()}(),d}])}),define("appraisals/controllers/modals/add-contacts-modal-ctrl",["appraisals/modules/controllers","common/models/contact","common/models/group","common/models/option-group"],function(e){"use strict";e.controller("AddContactsModalCtrl",["$q","$log","$controller","$uibModalInstance","$rootScope","$scope","$state","Appraisal","Contact","Group","OptionGroup",function(e,t,r,n,a,i,o,l,s,c,u){t.debug("AddContactsModalCtrl");var p=Object.create(r("BasicModalCtrl",{$uibModalInstance:n}));return p.confirmScreen=!1,p.groups=[],p.criteria={},p.optionValues={},p.contacts={lookedUp:[],matching:[]},p.loading={addingContacts:!1,groups:!0,matchingContacts:!1,optionValues:!0},p.addContacts=function(){p.loading.addingContacts=!0,e.all(p.contacts.matching.map(function(e){return l.create({appraisal_cycle_id:i.cycleId,contact_id:e.id})})).then(function(e){a.$emit("Appraisal::new",e),n.close(),o.go("appraisals.appraisal-cycle.appraisals-in-cycle",{cycleId:i.cycleId})})},p.fetchContacts=function(){var t=_.clone(p.criteria),r=[];p.confirmScreen=!0,p.loading.matchingContacts=!0,t.contact_id&&(r.push(s.find(t.contact_id).then(function(e){return[e]})),t=_.omit(t,"contact_id")),_.isEmpty(t)||r.push(s.all(t).then(function(e){return e.list})),e.all(r).then(function(e){p.contacts.matching=_(e).flatten().uniq().value(),p.loading.matchingContacts=!1})},p.lookupContact=function(e){e&&s.all({display_name:e}).then(function(e){p.contacts.lookedUp=e})},p.resetSearch=function(){p.criteria={},p.contacts.matching=[],p.confirmScreen=!1},function(){c.all().then(function(e){p.loading.groups=!1,p.groups=e.list}),u.valuesOf(["hrjc_department","hrjc_region","hrjc_location","hrjc_level_type"]).then(function(e){p.loading.optionValues=!1,p.optionValues=e})}(),p}])}),define("appraisals/controllers/modals/view-cycle-modal-ctrl",["appraisals/modules/controllers"],function(e){"use strict";e.controller("ViewCycleModalCtrl",["$log","$controller","$uibModalInstance",function(e,t,r){return e.debug("ViewCycleModalCtrl"),Object.create(t("BasicModalCtrl",{$uibModalInstance:r}))}])}),define("appraisals/controllers/modals/send-notification-reminder-modal-ctrl",["appraisals/modules/controllers"],function(e){"use strict";e.controller("SendNotificationReminderModalCtrl",["$log","$controller","$uibModal","$uibModalInstance","$rootElement",function(e,t,r,n,a){e.debug("SendNotificationReminderModalCtrl");var i=Object.create(t("BasicModalCtrl",{$uibModalInstance:n}));return i.openNotificationRecipientsModal=function(){r.open({appendTo:a.children().eq(0),controller:"NotificationRecipientsModalCtrl",controllerAs:"modal",bindToController:!0,templateUrl:CRM.vars.appraisals.baseURL+"/views/modals/notification-recipients.html"})},i}])}),define("appraisals/controllers/modals/notification-recipients-modal-ctrl",["appraisals/modules/controllers"],function(e){"use strict";e.controller("NotificationRecipientsModalCtrl",["$log","$controller","$uibModalInstance",function(e,t,r){return e.debug("NotificationRecipientsModalCtrl"),Object.create(t("BasicModalCtrl",{$uibModalInstance:r}))}])}),define("appraisals/modules/directives",["common/angular"],function(e){return e.module("appraisals.directives",[])}),define("appraisals/directives/show-more",["appraisals/modules/directives"],function(e){e.directive("crmShowMore",["$log",function(e){function t(t){void 0===t.callback&&e.error("[callback] is mandatory"),void 0===t.done&&e.error("[done] is mandatory")}return{scope:{callback:"&",done:"="},transclude:!0,replace:!0,templateUrl:CRM.vars.appraisals.baseURL+"/views/directives/show-more.html",controllerAs:"showMore",controller:["$scope",function(t){e.debug("crmShowMore"),this.callback=t.callback,t.$watch("done",function(e){this.done=e}.bind(this))}],link:function(e,r,n){t(n)}}}])}),define("appraisals/directives/grades-chart",["common/d3","appraisals/modules/directives"],function(e,t){"use strict";t.directive("crmGradesChart",["$log",function(t){function r(e){var t={};return t.outer={height:e.clientHeight,width:e.clientWidth},t.inner={width:t.outer.width-c.left-c.right,height:t.outer.height-c.top-c.bottom},t}function n(e){return void 0!==e.chartData||(t.error("[chart-data] is mandatory"),!1)}function a(e){e.innerHTML=""}function i(t){return{x:e.svg.axis().scale(t.x).tickFormat(function(e,t){return t+1}).orient("bottom"),y:e.svg.axis().scale(t.y).orient("left").ticks(4)}}function o(t,r){return{x:e.scale.ordinal().domain(e.range(r.length)).rangeBands([0,t.inner.width],.3),y:e.scale.linear().domain([0,100]).range([t.inner.height,0])}}function l(t,n){var a=r(t),l=o(a,n),s=i(l),u=e.select(t).append("svg").attr("width",a.outer.width).attr("height",a.outer.height).append("g").attr("transform","translate("+c.left+", "+c.top+")");u.append("g").attr("class","chart-axis chart-axis-x").attr("transform","translate(0,"+a.inner.height+")").call(s.x),u.append("g").attr("class","chart-axis chart-axis-y").call(s.y),u.selectAll("rect").data(n).enter().append("rect").attr("x",function(e,t){return l.x(t)}).attr("y",function(e){return l.y(e.value)}).attr("width",l.x.rangeBand()).attr("height",function(e){return a.inner.height-l.y(e.value)}).attr("class",function(e,t){return"chart-color-"+t})}function s(e){var r=!0;return Array.isArray(e)?e.every(function(e){return e.label&&e.value})||(r=!1)||t.error("Elements in [chart-data] must have a `label` and a `value` property"):(r=!1)||t.error("[chart-data] must be an array of objects"),r}var c={top:30,bottom:30,left:50,right:30};return{scope:{chartData:"="},restrict:"A",link:function(e,r,i){t.debug("crmGradesChart"),n(i)&&(r=r[0],e.$watch("chartData",function(e){a(r),s(e)&&l(r,e)}),window.onresize=function(){a(r),l(r,e.chartData)})}}}])}),define("appraisals/models/appraisal",["appraisals/modules/models","common/models/model","common/mocks/services/api/appraisal-mock"],function(e){"use strict";e.factory("Appraisal",["$log","Model","api.appraisal.mock","AppraisalInstance",function(e,t,r,n){return t.extend({all:function(e,t){return r.all(this.processFilters(e),t).then(function(e){return e.list=e.list.map(function(e){return n.init(e,!0)}),e})},create:function(t){t.contact_id||e.error("ERR_APPRAISAL_CREATE: CONTACT ID MISSING"),t.appraisal_cycle_id||e.error("ERR_APPRAISAL_CREATE: APPRAISAL CYCLE ID MISSING");var a=n.init(t).toAPI();return r.create(a).then(function(e){return n.init(e,!0)})},find:function(e){return r.find(e).then(function(e){return n.init(e,!0)})},overdue:function(e){return r.overdue(e).then(function(e){return e.list=e.list.map(function(e){return n.init(e,!0)}),e})}})}])}),define("appraisals/models/instances/appraisal-instance",["common/lodash","common/moment","appraisals/modules/models-instances","common/models/instances/instance"],function(e,t,r){"use strict";r.factory("AppraisalInstance",["ModelInstance","HR_settings",function(r,n){var a=["meeting_completed","approved_by_employee","is_current"];return r.extend({fromAPIFilter:function(r,i,o){var l=n.DATE_FORMAT.toUpperCase();e.endsWith(o,"_date")||e.endsWith(o,"_due")?r[o]=t(this[o],"YYYY-MM-DD").format(l):e.includes(a,o)?r[o]=!!+this[o]:r[o]=this[o]},toAPIFilter:function(r,i,o){var l=n.DATE_FORMAT.toUpperCase();e.endsWith(o,"_date")||e.endsWith(o,"_due")?r[o]=t(this[o],l).format("YYYY-MM-DD"):e.includes(a,o)?r[o]=""+ +this[o]:r[o]=this[o]}})}])}),define("appraisals/models/instances/appraisal-cycle-instance",["common/lodash","common/moment","appraisals/modules/models-instances","common/services/api/appraisal-cycle","common/models/instances/instance","appraisals/models/appraisal"],function(e,t,r){"use strict";r.factory("AppraisalCycleInstance",["$q","Appraisal","ModelInstance","api.appraisal-cycle","HR_settings",function(r,n,a,i,o){function l(t){this.statuses=e.reduce(t,function(e,t){return e[t.status_id]={name:t.status_name,appraisals_count:t.appraisals_count},t.appraisals&&(e[t.status_id].appraisals=t.appraisals),this.appraisals_count+=+t.appraisals_count,e},{},this),this.appraisals_count>0&&(this.completion_percentage=Math.round(100*this.statuses[5].appraisals_count/this.appraisals_count))}var s={cycle_self_appraisal_due:"1",cycle_manager_appraisal_due:"2",cycle_grade_due:"3"},c=e.memoize(function(r,n){var a,i,l;o.DATE_FORMAT.toUpperCase();return a=t(),i=e.chain(n).transform(function(e,r,n){e[n]=t(r)}).pick(function(e){return e.isSameOrAfter(a,"day")}).value(),e.isEmpty(i)?null:(l=t.min.apply(t,e.values(i)),{date:l.toDate(),status_id:s[e.findKey(i,function(e){return e===e})]})});return a.extend({defaultCustomData:function(){return{appraisals:[],appraisals_count:0,completion_percentage:0,statuses:{}}},dueDates:function(){return e.pick(this.attributes(),function(t,r){return e.endsWith(r,"_due")})},fromAPIFilter:function(r,n,a){e.endsWith(a,"_date")||e.endsWith(a,"_due")?r[a]=t(this[a],"YYYY-MM-DD").toDate():"api.AppraisalCycle.getappraisalsperstep"===a?l.call(r,this[a].values):r[a]="cycle_is_active"===a?!!+this[a]:this[a]},isStatusOverdue:function(r){var n=e.invert(s)[r];return t(this[n]).isBefore(t())},loadAppraisals:function(e){var t="all";return void 0!==e&&!0===e.overdue&&(t="overdue"),n[t]({appraisal_cycle_id:this.id}).then(function(e){this.appraisals=e.list}.bind(this))},nextDueDate:function(){var t=this.dueDates(),r=(this.id||this.name)+e.values(t).join("");return c(r,t)},toAPIFilter:function(r,n,a){var i=["appraisals","appraisals_count","completion_percentage"];if(e.endsWith(a,"_date")||e.endsWith(a,"_due"))r[a]=t(this[a]).format("YYYY-MM-DD");else{if(e.includes(i,a))return;r[a]=this[a]}},update:function(t){var n=r.defer();return this.id?n.resolve(i.update(this.toAPI()).then(function(t){e.assign(this,this.fromAPI(t))}.bind(this))):n.reject("ERR_UPDATE: ID_MISSING"),n.promise}})}])}),"undefined"!=typeof module&&"undefined"!=typeof exports&&module.exports===exports&&(module.exports="ui.router"),function(e,t,r){"use strict";function n(e,t){return T(new(T(function(){},{prototype:e})),t)}function a(e){return F(arguments,function(t){t!==e&&F(t,function(t,r){e.hasOwnProperty(r)||(e[r]=t)})}),e}function i(e,t){var r=[];for(var n in e.path){if(e.path[n]!==t.path[n])break;r.push(e.path[n])}return r}function o(e){if(Object.keys)return Object.keys(e);var t=[];return F(e,function(e,r){t.push(r)}),t}function l(e,t){if(Array.prototype.indexOf)return e.indexOf(t,Number(arguments[2])||0);var r=e.length>>>0,n=Number(arguments[2])||0;for(0>(n=0>n?Math.ceil(n):Math.floor(n))&&(n+=r);r>n;n++)if(n in e&&e[n]===t)return n;return-1}function s(e,t,r,n){var a,s=i(r,n),c={},u=[];for(var p in s)if(s[p].params&&(a=o(s[p].params),a.length))for(var f in a)l(u,a[f])>=0||(u.push(a[f]),c[a[f]]=e[a[f]]);return T({},c,t)}function c(e,t,r){if(!r){r=[];for(var n in e)r.push(n)}for(var a=0;a<r.length;a++){var i=r[a];if(e[i]!=t[i])return!1}return!0}function u(e,t){var r={};return F(e,function(e){r[e]=t[e]}),r}function p(e){var t={},r=Array.prototype.concat.apply(Array.prototype,Array.prototype.slice.call(arguments,1));return F(r,function(r){r in e&&(t[r]=e[r])}),t}function f(e){var t={},r=Array.prototype.concat.apply(Array.prototype,Array.prototype.slice.call(arguments,1));for(var n in e)-1==l(r,n)&&(t[n]=e[n]);return t}function d(e,t){var r=U(e),n=r?[]:{};return F(e,function(e,a){t(e,a)&&(n[r?n.length:a]=e)}),n}function m(e,t){var r=U(e)?[]:{};return F(e,function(e,n){r[n]=t(e,n)}),r}function h(e,t){var n=1,i=2,s={},c=[],u=s,p=T(e.when(s),{$$promises:s,$$values:s});this.study=function(s){function d(e,r){if(y[r]!==i){if($.push(r),y[r]===n)throw $.splice(0,l($,r)),new Error("Cyclic dependency: "+$.join(" -> "));if(y[r]=n,k(e))v.push(r,[function(){return t.get(e)}],c);else{var a=t.annotate(e);F(a,function(e){e!==r&&s.hasOwnProperty(e)&&d(s[e],e)}),v.push(r,e,a)}$.pop(),y[r]=i}}function m(e){return q(e)&&e.then&&e.$$promises}if(!q(s))throw new Error("'invocables' must be an object");var h=o(s||{}),v=[],$=[],y={};return F(s,d),s=$=y=null,function(n,i,o){function l(){--g||(w||a(y,i.$$values),d.$$values=y,d.$$promises=d.$$promises||!0,delete d.$$inheritedValues,c.resolve(y))}function s(e){d.$$failure=e,c.reject(e)}if(m(n)&&o===r&&(o=i,i=n,n=null),n){if(!q(n))throw new Error("'locals' must be an object")}else n=u;if(i){if(!m(i))throw new Error("'parent' must be a promise returned by $resolve.resolve()")}else i=p;var c=e.defer(),d=c.promise,$=d.$$promises={},y=T({},n),g=1+v.length/3,w=!1;if(j(i.$$failure))return s(i.$$failure),d;i.$$inheritedValues&&a(y,f(i.$$inheritedValues,h)),T($,i.$$promises),i.$$values?(w=a(y,f(i.$$values,h)),d.$$inheritedValues=f(i.$$values,h),l()):(i.$$inheritedValues&&(d.$$inheritedValues=f(i.$$inheritedValues,h)),i.then(l,s));for(var b=0,C=v.length;C>b;b+=3)n.hasOwnProperty(v[b])?l():function(r,a,i){function c(e){p.reject(e),s(e)}function u(){if(!j(d.$$failure))try{p.resolve(t.invoke(a,o,y)),p.promise.then(function(e){y[r]=e,l()},c)}catch(e){c(e)}}var p=e.defer(),f=0;F(i,function(e){$.hasOwnProperty(e)&&!n.hasOwnProperty(e)&&(f++,$[e].then(function(t){y[e]=t,--f||u()},c))}),f||u(),$[r]=p.promise}(v[b],v[b+1],v[b+2]);return d}},this.resolve=function(e,t,r,n){return this.study(e)(t,r,n)}}function v(e,t,r){this.fromConfig=function(e,t,r){return j(e.template)?this.fromString(e.template,t):j(e.templateUrl)?this.fromUrl(e.templateUrl,t):j(e.templateProvider)?this.fromProvider(e.templateProvider,t,r):null},this.fromString=function(e,t){return O(e)?e(t):e},this.fromUrl=function(r,n){return O(r)&&(r=r(n)),null==r?null:e.get(r,{cache:t,headers:{Accept:"text/html"}}).then(function(e){return e.data})},this.fromProvider=function(e,t,n){return r.invoke(e,null,n||{params:t})}}function $(e,t,a){function i(t,r,n,a){if(v.push(t),m[t])return m[t];if(!/^\w+(-+\w+)*(?:\[\])?$/.test(t))throw new Error("Invalid parameter name '"+t+"' in pattern '"+e+"'");if(h[t])throw new Error("Duplicate parameter name '"+t+"' in pattern '"+e+"'");return h[t]=new Y.Param(t,r,n,a),h[t]}function o(e,t,r,n){var a=["",""],i=e.replace(/[\\\[\]\^$*+?.()|{}]/g,"\\$&");if(!t)return i;switch(r){case!1:a=["(",")"+(n?"?":"")];break;case!0:a=["?(",")?"];break;default:a=["("+r+"|",")?"]}return i+a[0]+t+a[1]}function l(a,i){var o,l,s,c,u;return o=a[2]||a[3],u=t.params[o],s=e.substring(f,a.index),l=i?a[4]:a[4]||("*"==a[1]?".*":null),c=Y.type(l||"string")||n(Y.type("string"),{pattern:new RegExp(l,t.caseInsensitive?"i":r)}),{id:o,regexp:l,segment:s,type:c,cfg:u}}t=T({params:{}},q(t)?t:{});var s,c=/([:*])([\w\[\]]+)|\{([\w\[\]]+)(?:\:((?:[^{}\\]+|\\.|\{(?:[^{}\\]+|\\.)*\})+))?\}/g,u=/([:]?)([\w\[\]-]+)|\{([\w\[\]-]+)(?:\:((?:[^{}\\]+|\\.|\{(?:[^{}\\]+|\\.)*\})+))?\}/g,p="^",f=0,d=this.segments=[],m=a?a.params:{},h=this.params=a?a.params.$$new():new Y.ParamSet,v=[];this.source=e;for(var $,y,g;(s=c.exec(e))&&($=l(s,!1),!($.segment.indexOf("?")>=0));)y=i($.id,$.type,$.cfg,"path"),p+=o($.segment,y.type.pattern.source,y.squash,y.isOptional),d.push($.segment),f=c.lastIndex;g=e.substring(f);var w=g.indexOf("?");if(w>=0){var b=this.sourceSearch=g.substring(w);if(g=g.substring(0,w),this.sourcePath=e.substring(0,f+w),b.length>0)for(f=0;s=u.exec(b);)$=l(s,!0),y=i($.id,$.type,$.cfg,"search"),f=c.lastIndex}else this.sourcePath=e,this.sourceSearch="";p+=o(g)+(!1===t.strict?"/?":"")+"$",d.push(g),this.regexp=new RegExp(p,t.caseInsensitive?"i":r),this.prefix=d[0],this.$$paramNames=v}function y(e){T(this,e)}function g(){function e(e){return null!=e?e.toString().replace(/\//g,"%2F"):e}function a(e){return null!=e?e.toString().replace(/%2F/g,"/"):e}function i(){return{strict:h,caseInsensitive:f}}function s(e){return O(e)||U(e)&&O(e[e.length-1])}function c(){for(;C.length;){var e=C.shift();if(e.pattern)throw new Error("You cannot override a type's .pattern at runtime.");t.extend(w[e.name],p.invoke(e.def))}}function u(e){T(this,e||{})}Y=this;var p,f=!1,h=!0,v=!1,w={},b=!0,C=[],A={string:{encode:e,decode:a,is:function(e){return null==e||!j(e)||"string"==typeof e},pattern:/[^\/]*/},int:{encode:e,decode:function(e){return parseInt(e,10)},is:function(e){return j(e)&&this.decode(e.toString())===e},pattern:/\d+/},bool:{encode:function(e){return e?1:0},decode:function(e){return 0!==parseInt(e,10)},is:function(e){return!0===e||!1===e},pattern:/0|1/},date:{encode:function(e){return this.is(e)?[e.getFullYear(),("0"+(e.getMonth()+1)).slice(-2),("0"+e.getDate()).slice(-2)].join("-"):r},decode:function(e){if(this.is(e))return e;var t=this.capture.exec(e);return t?new Date(t[1],t[2]-1,t[3]):r},is:function(e){return e instanceof Date&&!isNaN(e.valueOf())},equals:function(e,t){return this.is(e)&&this.is(t)&&e.toISOString()===t.toISOString()},pattern:/[0-9]{4}-(?:0[1-9]|1[0-2])-(?:0[1-9]|[1-2][0-9]|3[0-1])/,capture:/([0-9]{4})-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])/},json:{encode:t.toJson,decode:t.fromJson,is:t.isObject,equals:t.equals,pattern:/[^\/]*/},any:{encode:t.identity,decode:t.identity,equals:t.equals,pattern:/.*/}};g.$$getDefaultValue=function(e){if(!s(e.value))return e.value;if(!p)throw new Error("Injectable functions cannot be called at configuration time");return p.invoke(e.value)},this.caseInsensitive=function(e){return j(e)&&(f=e),f},this.strictMode=function(e){return j(e)&&(h=e),h},this.defaultSquashPolicy=function(e){if(!j(e))return v;if(!0!==e&&!1!==e&&!k(e))throw new Error("Invalid squash policy: "+e+". Valid policies: false, true, arbitrary-string");return v=e,e},this.compile=function(e,t){return new $(e,T(i(),t))},this.isMatcher=function(e){if(!q(e))return!1;var t=!0;return F($.prototype,function(r,n){O(r)&&(t=t&&j(e[n])&&O(e[n]))}),t},this.type=function(e,t,r){if(!j(t))return w[e];if(w.hasOwnProperty(e))throw new Error("A type named '"+e+"' has already been defined.");return w[e]=new y(T({name:e},t)),r&&(C.push({name:e,def:r}),b||c()),this},F(A,function(e,t){w[t]=new y(T({name:t},e))}),w=n(w,{}),this.$get=["$injector",function(e){return p=e,b=!1,c(),F(A,function(e,t){w[t]||(w[t]=new y(e))}),this}],this.Param=function(e,t,n,a){function i(){if(!p)throw new Error("Injectable functions cannot be called at configuration time");var e=p.invoke(n.$$fn);if(null!==e&&e!==r&&!f.type.is(e))throw new Error("Default value ("+e+") for parameter '"+f.id+"' is not an instance of Type ("+f.type.name+")");return e}function c(e){function t(e){return function(t){return t.from===e}}return e=function(e){var r=m(d(f.replace,t(e)),function(e){return e.to});return r.length?r[0]:e}(e),j(e)?f.type.$normalize(e):i()}function u(){return"{Param:"+e+" "+t+" squash: '"+g+"' optional: "+$+"}"}var f=this;n=function(e){var t=q(e)?o(e):[];return-1===l(t,"value")&&-1===l(t,"type")&&-1===l(t,"squash")&&-1===l(t,"array")&&(e={value:e}),e.$$fn=s(e.value)?e.value:function(){return e.value},e}(n),t=function(t,r,n){if(t.type&&r)throw new Error("Param '"+e+"' has two type configurations.");return r||(t.type?t.type instanceof y?t.type:new y(t.type):"config"===n?w.any:w.string)}(n,t,a);var h=function(){var t={array:"search"===a&&"auto"},r=e.match(/\[\]$/)?{array:!0}:{};return T(t,r,n).array}();t=h?t.$asArray(h,"search"===a):t,"string"!==t.name||h||"path"!==a||n.value!==r||(n.value="");var $=n.value!==r,g=function(e,t){var r=e.squash;if(!t||!1===r)return!1;if(!j(r)||null==r)return v;if(!0===r||k(r))return r;throw new Error("Invalid squash policy: '"+r+"'. Valid policies: false, true, or arbitrary string")}(n,$),b=function(e,t,n,a){var i,o,s=[{from:"",to:n||t?r:""},{from:null,to:n||t?r:""}]
;return i=U(e.replace)?e.replace:[],k(a)&&i.push({from:a,to:r}),o=m(i,function(e){return e.from}),d(s,function(e){return-1===l(o,e.from)}).concat(i)}(n,h,$,g);T(this,{id:e,type:t,location:a,array:h,squash:g,replace:b,isOptional:$,value:c,dynamic:r,config:n,toString:u})},u.prototype={$$new:function(){return n(this,T(new u,{$$parent:this}))},$$keys:function(){for(var e=[],t=[],r=this,n=o(u.prototype);r;)t.push(r),r=r.$$parent;return t.reverse(),F(t,function(t){F(o(t),function(t){-1===l(e,t)&&-1===l(n,t)&&e.push(t)})}),e},$$values:function(e){var t={},r=this;return F(r.$$keys(),function(n){t[n]=r[n].value(e&&e[n])}),t},$$equals:function(e,t){var r=!0,n=this;return F(n.$$keys(),function(a){var i=e&&e[a],o=t&&t[a];n[a].type.equals(i,o)||(r=!1)}),r},$$validates:function(e){var n,a,i,o,l,s=this.$$keys();for(n=0;n<s.length&&(a=this[s[n]],(i=e[s[n]])!==r&&null!==i||!a.isOptional);n++){if(o=a.type.$normalize(i),!a.type.is(o))return!1;if(l=a.type.encode(o),t.isString(l)&&!a.type.pattern.exec(l))return!1}return!0},$$parent:r},this.ParamSet=u}function w(e,n){function a(e){var t=/^\^((?:\\[^a-zA-Z0-9]|[^\\\[\]\^$*+?.()|{}]+)*)/.exec(e.source);return null!=t?t[1].replace(/\\(.)/g,"$1"):""}function i(e,t){return e.replace(/\$(\$|\d{1,2})/,function(e,r){return t["$"===r?0:Number(r)]})}function o(e,t,r){if(!r)return!1;var n=e.invoke(t,t,{$match:r});return!j(n)||n}function l(n,a,i,o){function l(e,t,r){return"/"===h?e:t?h.slice(0,-1)+e:r?h.slice(1)+e:e}function f(e){function t(e){var t=e(i,n);return!!t&&(k(t)&&n.replace().url(t),!0)}if(!e||!e.defaultPrevented){m&&n.url(),m=r;var a,o=c.length;for(a=0;o>a;a++)if(t(c[a]))return;u&&t(u)}}function d(){return s=s||a.$on("$locationChangeSuccess",f)}var m,h=o.baseHref(),v=n.url();return p||d(),{sync:function(){f()},listen:function(){return d()},update:function(e){return e?void(v=n.url()):void(n.url()!==v&&(n.url(v),n.replace()))},push:function(e,t,a){var i=e.format(t||{});null!==i&&t&&t["#"]&&(i+="#"+t["#"]),n.url(i),m=a&&a.$$avoidResync?n.url():r,a&&a.replace&&n.replace()},href:function(r,a,i){if(!r.validates(a))return null;var o=e.html5Mode();t.isObject(o)&&(o=o.enabled);var s=r.format(a);if(i=i||{},o||null===s||(s="#"+e.hashPrefix()+s),null!==s&&a&&a["#"]&&(s+="#"+a["#"]),s=l(s,o,i.absolute),!i.absolute||!s)return s;var c=!o&&s?"/":"",u=n.port();return u=80===u||443===u?"":":"+u,[n.protocol(),"://",n.host(),u,c,s].join("")}}}var s,c=[],u=null,p=!1;this.rule=function(e){if(!O(e))throw new Error("'rule' must be a function");return c.push(e),this},this.otherwise=function(e){if(k(e)){var t=e;e=function(){return t}}else if(!O(e))throw new Error("'rule' must be a function");return u=e,this},this.when=function(e,t){var r,l=k(t);if(k(e)&&(e=n.compile(e)),!l&&!O(t)&&!U(t))throw new Error("invalid 'handler' in when()");var s={matcher:function(e,t){return l&&(r=n.compile(t),t=["$match",function(e){return r.format(e)}]),T(function(r,n){return o(r,t,e.exec(n.path(),n.search()))},{prefix:k(e.prefix)?e.prefix:""})},regex:function(e,t){if(e.global||e.sticky)throw new Error("when() RegExp must not be global or sticky");return l&&(r=t,t=["$match",function(e){return i(r,e)}]),T(function(r,n){return o(r,t,e.exec(n.path()))},{prefix:a(e)})}},c={matcher:n.isMatcher(e),regex:e instanceof RegExp};for(var u in c)if(c[u])return this.rule(s[u](e,t));throw new Error("invalid 'what' in when()")},this.deferIntercept=function(e){e===r&&(e=!0),p=e},this.$get=l,l.$inject=["$location","$rootScope","$injector","$browser"]}function b(e,a){function i(e){return 0===e.indexOf(".")||0===e.indexOf("^")}function f(e,t){if(!e)return r;var n=k(e),a=n?e:e.name;if(i(a)){if(!t)throw new Error("No reference point given for path '"+a+"'");t=f(t);for(var o=a.split("."),l=0,s=o.length,c=t;s>l;l++)if(""!==o[l]||0!==l){if("^"!==o[l])break;if(!c.parent)throw new Error("Path '"+a+"' not valid for state '"+t.name+"'");c=c.parent}else c=t;o=o.slice(l).join("."),a=c.name+(c.name&&o?".":"")+o}var u=M[a];return!u||!n&&(n||u!==e&&u.self!==e)?r:u}function d(e,t){E[e]||(E[e]=[]),E[e].push(t)}function h(e){for(var t=E[e]||[];t.length;)v(t.shift())}function v(t){t=n(t,{self:t,resolve:t.resolve||{},toString:function(){return this.name}});var r=t.name;if(!k(r)||r.indexOf("@")>=0)throw new Error("State must have a valid name");if(M.hasOwnProperty(r))throw new Error("State '"+r+"'' is already defined");var a=-1!==r.indexOf(".")?r.substring(0,r.lastIndexOf(".")):k(t.parent)?t.parent:q(t.parent)&&k(t.parent.name)?t.parent.name:"";if(a&&!M[a])return d(a,t.self);for(var i in I)O(I[i])&&(t[i]=I[i](t,I.$delegates[i]));return M[r]=t,!t[S]&&t.url&&e.when(t.url,["$match","$stateParams",function(e,r){_.$current.navigable==t&&c(e,r)||_.transitionTo(t,e,{inherit:!0,location:!1})}]),h(r),t}function $(e){return e.indexOf("*")>-1}function y(e){for(var t=e.split("."),r=_.$current.name.split("."),n=0,a=t.length;a>n;n++)"*"===t[n]&&(r[n]="*");return"**"===t[0]&&(r=r.slice(l(r,t[1])),r.unshift("**")),"**"===t[t.length-1]&&(r.splice(l(r,t[t.length-2])+1,Number.MAX_VALUE),r.push("**")),t.length==r.length&&r.join("")===t.join("")}function g(e,t){return k(e)&&!j(t)?I[e]:O(t)&&k(e)?(I[e]&&!I.$delegates[e]&&(I.$delegates[e]=I[e]),I[e]=t,this):this}function w(e,t){return q(e)?t=e:t.name=e,v(t),this}function b(e,a,i,l,p,d,h,v,g){function w(t,r,n,i){var o=e.$broadcast("$stateNotFound",t,r,n);if(o.defaultPrevented)return h.update(),P;if(!o.retry)return null;if(i.$retry)return h.update(),x;var l=_.transition=a.when(o.retry);return l.then(function(){return l!==_.transition?E:(t.options.$retry=!0,_.transitionTo(t.to,t.toParams,t.options))},function(){return P}),h.update(),l}function b(e,r,n,o,s,c){function f(){var r=[];return F(e.views,function(n,a){var o=n.resolve&&n.resolve!==e.resolve?n.resolve:{};o.$template=[function(){return i.load(a,{view:n,locals:s.globals,params:d,notify:c.notify})||""}],r.push(p.resolve(o,s.globals,s.resolve,e).then(function(r){if(O(n.controllerProvider)||U(n.controllerProvider)){var i=t.extend({},o,s.globals);r.$$controller=l.invoke(n.controllerProvider,null,i)}else r.$$controller=n.controller;r.$$state=e,r.$$controllerAs=n.controllerAs,s[a]=r}))}),a.all(r).then(function(){return s.globals})}var d=n?r:u(e.params.$$keys(),r),m={$stateParams:d};s.resolve=p.resolve(e.resolve,m,s.resolve,e);var h=[s.resolve.then(function(e){s.globals=e})];return o&&h.push(o),a.all(h).then(f).then(function(e){return s})}var E=a.reject(new Error("transition superseded")),I=a.reject(new Error("transition prevented")),P=a.reject(new Error("transition aborted")),x=a.reject(new Error("transition failed"));return A.locals={resolve:null,globals:{$stateParams:{}}},_={params:{},current:A.self,$current:A,transition:null},_.reload=function(e){return _.transitionTo(_.current,d,{reload:e||!0,inherit:!1,notify:!0})},_.go=function(e,t,r){return _.transitionTo(e,t,T({inherit:!0,relative:_.$current},r))},_.transitionTo=function(t,r,i){r=r||{},i=T({location:!0,inherit:!1,relative:null,notify:!0,reload:!1,$retry:!1},i||{});var o,c=_.$current,p=_.params,m=c.path,v=f(t,i.relative),$=r["#"];if(!j(v)){var y={to:t,toParams:r,options:i},g=w(y,c.self,p,i);if(g)return g;if(t=y.to,r=y.toParams,i=y.options,v=f(t,i.relative),!j(v)){if(!i.relative)throw new Error("No such state '"+t+"'");throw new Error("Could not resolve '"+t+"' from state '"+i.relative+"'")}}if(v[S])throw new Error("Cannot transition to abstract state '"+t+"'");if(i.inherit&&(r=s(d,r||{},_.$current,v)),!v.params.$$validates(r))return x;r=v.params.$$values(r),t=v;var M=t.path,P=0,R=M[P],D=A.locals,O=[];if(i.reload){if(k(i.reload)||q(i.reload)){if(q(i.reload)&&!i.reload.name)throw new Error("Invalid reload state object");var U=!0===i.reload?m[0]:f(i.reload);if(i.reload&&!U)throw new Error("No such reload state '"+(k(i.reload)?i.reload:i.reload.name)+"'");for(;R&&R===m[P]&&R!==U;)D=O[P]=R.locals,P++,R=M[P]}}else for(;R&&R===m[P]&&R.ownParams.$$equals(r,p);)D=O[P]=R.locals,P++,R=M[P];if(C(t,r,c,p,D,i))return $&&(r["#"]=$),_.params=r,V(_.params,d),i.location&&t.navigable&&t.navigable.url&&(h.push(t.navigable.url,r,{$$avoidResync:!0,replace:"replace"===i.location}),h.update(!0)),_.transition=null,a.when(_.current);if(r=u(t.params.$$keys(),r||{}),i.notify&&e.$broadcast("$stateChangeStart",t.self,r,c.self,p).defaultPrevented)return e.$broadcast("$stateChangeCancel",t.self,r,c.self,p),h.update(),I;for(var F=a.when(D),Y=P;Y<M.length;Y++,R=M[Y])D=O[Y]=n(D),F=b(R,r,R===t,F,D,i);var N=_.transition=F.then(function(){var n,a,o;if(_.transition!==N)return E;for(n=m.length-1;n>=P;n--)o=m[n],o.self.onExit&&l.invoke(o.self.onExit,o.self,o.locals.globals),o.locals=null;for(n=P;n<M.length;n++)a=M[n],a.locals=O[n],a.self.onEnter&&l.invoke(a.self.onEnter,a.self,a.locals.globals);return $&&(r["#"]=$),_.transition!==N?E:(_.$current=t,_.current=t.self,_.params=r,V(_.params,d),_.transition=null,i.location&&t.navigable&&h.push(t.navigable.url,t.navigable.locals.globals.$stateParams,{$$avoidResync:!0,replace:"replace"===i.location}),i.notify&&e.$broadcast("$stateChangeSuccess",t.self,r,c.self,p),h.update(!0),_.current)},function(n){return _.transition!==N?E:(_.transition=null,o=e.$broadcast("$stateChangeError",t.self,r,c.self,p,n),o.defaultPrevented||h.update(),a.reject(n))});return N},_.is=function(e,t,n){n=T({relative:_.$current},n||{});var a=f(e,n.relative);return j(a)?_.$current===a&&(!t||c(a.params.$$values(t),d)):r},_.includes=function(e,t,n){if(n=T({relative:_.$current},n||{}),k(e)&&$(e)){if(!y(e))return!1;e=_.$current.name}var a=f(e,n.relative);return j(a)?!!j(_.$current.includes[a.name])&&(!t||c(a.params.$$values(t),d,o(t))):r},_.href=function(e,t,n){n=T({lossy:!0,inherit:!0,absolute:!1,relative:_.$current},n||{});var a=f(e,n.relative);if(!j(a))return null;n.inherit&&(t=s(d,t||{},_.$current,a));var i=a&&n.lossy?a.navigable:a;return i&&i.url!==r&&null!==i.url?h.href(i.url,u(a.params.$$keys().concat("#"),t||{}),{absolute:n.absolute}):null},_.get=function(e,t){if(0===arguments.length)return m(o(M),function(e){return M[e].self});var r=f(e,t||_.$current);return r&&r.self?r.self:null},_}function C(e,t,r,n,a,i){return!(i.reload||e!==r||!(a===r.locals||!1===e.self.reloadOnSearch&&function(e,t,r){function n(t){return"search"!=e.params[t].location}var a=e.params.$$keys().filter(n),i=p.apply({},[e.params].concat(a));return new Y.ParamSet(i).$$equals(t,r)}(r,n,t)))||void 0}var A,_,M={},E={},S="abstract",I={parent:function(e){if(j(e.parent)&&e.parent)return f(e.parent);var t=/^(.+)\.[^.]+$/.exec(e.name);return t?f(t[1]):A},data:function(e){return e.parent&&e.parent.data&&(e.data=e.self.data=T({},e.parent.data,e.data)),e.data},url:function(e){var t=e.url,r={params:e.params||{}};if(k(t))return"^"==t.charAt(0)?a.compile(t.substring(1),r):(e.parent.navigable||A).url.concat(t,r);if(!t||a.isMatcher(t))return t;throw new Error("Invalid url '"+t+"' in state '"+e+"'")},navigable:function(e){return e.url?e:e.parent?e.parent.navigable:null},ownParams:function(e){var t=e.url&&e.url.params||new Y.ParamSet;return F(e.params||{},function(e,r){t[r]||(t[r]=new Y.Param(r,null,e,"config"))}),t},params:function(e){return e.parent&&e.parent.params?T(e.parent.params.$$new(),e.ownParams):new Y.ParamSet},views:function(e){var t={};return F(j(e.views)?e.views:{"":e},function(r,n){n.indexOf("@")<0&&(n+="@"+e.parent.name),t[n]=r}),t},path:function(e){return e.parent?e.parent.path.concat(e):[]},includes:function(e){var t=e.parent?T({},e.parent.includes):{};return t[e.name]=!0,t},$delegates:{}};A=v({name:"",url:"^",views:null,abstract:!0}),A.navigable=null,this.decorator=g,this.state=w,this.$get=b,b.$inject=["$rootScope","$q","$view","$injector","$resolve","$stateParams","$urlRouter","$location","$urlMatcherFactory"]}function C(){function e(e,t){return{load:function(r,n){var a;return n=T({template:null,controller:null,view:null,locals:null,notify:!0,async:!0,params:{}},n),n.view&&(a=t.fromConfig(n.view,n.params,n.locals)),a&&n.notify&&e.$broadcast("$viewContentLoading",n),a}}}this.$get=e,e.$inject=["$rootScope","$templateFactory"]}function A(){var e=!1;this.useAnchorScroll=function(){e=!0},this.$get=["$anchorScroll","$timeout",function(t,r){return e?t:function(e){return r(function(){e[0].scrollIntoView()},0,!1)}}]}function _(e,r,n,a){function i(e,t){if(s)return{enter:function(e,t,r){var n=s.enter(e,null,t,r);n&&n.then&&n.then(r)},leave:function(e,t){var r=s.leave(e,t);r&&r.then&&r.then(t)}};if(l){var r=l&&l(t,e);return{enter:function(e,t,n){r.enter(e,null,t),n()},leave:function(e,t){r.leave(e),t()}}}return function(){return{enter:function(e,t,r){t.after(e),r()},leave:function(e,t){e.remove(),t()}}}()}var o=function(){return r.has?function(e){return r.has(e)?r.get(e):null}:function(e){try{return r.get(e)}catch(e){return null}}}(),l=o("$animator"),s=o("$animate");return{restrict:"ECA",terminal:!0,priority:400,transclude:"element",compile:function(r,o,l){return function(r,o,s){function c(){p&&(p.remove(),p=null),d&&(d.$destroy(),d=null),f&&($.leave(f,function(){p=null}),p=f,f=null)}function u(i){var u,p=E(r,s,o,a),y=p&&e.$current&&e.$current.locals[p];if(i||y!==m){u=r.$new(),m=e.$current.locals[p];var g=l(u,function(e){$.enter(e,o,function(){d&&d.$emit("$viewContentAnimationEnded"),(t.isDefined(v)&&!v||r.$eval(v))&&n(e)}),c()});f=g,d=u,d.$emit("$viewContentLoaded"),d.$eval(h)}}var p,f,d,m,h=s.onload||"",v=s.autoscroll,$=i(s,r);r.$on("$stateChangeSuccess",function(){u(!1)}),r.$on("$viewContentLoading",function(){u(!1)}),u(!0)}}}}function M(e,t,r,n){return{restrict:"ECA",priority:-400,compile:function(a){var i=a.html();return function(a,o,l){var s=r.$current,c=E(a,l,o,n),u=s&&s.locals[c];if(u){o.data("$uiView",{name:c,state:u.$$state}),o.html(u.$template?u.$template:i);var p=e(o.contents());if(u.$$controller){u.$scope=a,u.$element=o;var f=t(u.$$controller,u);u.$$controllerAs&&(a[u.$$controllerAs]=f),o.data("$ngControllerController",f),o.children().data("$ngControllerController",f)}p(a)}}}}}function E(e,t,r,n){var a=n(t.uiView||t.name||"")(e),i=r.inheritedData("$uiView");return a.indexOf("@")>=0?a:a+"@"+(i?i.state.name:"")}function S(e,t){var r,n=e.match(/^\s*({[^}]*})\s*$/);if(n&&(e=t+"("+n[1]+")"),!(r=e.replace(/\n/g," ").match(/^([^(]+?)\s*(\((.*)\))?$/))||4!==r.length)throw new Error("Invalid state ref '"+e+"'");return{state:r[1],paramExpr:r[3]||null}}function I(e){var t=e.parent().inheritedData("$uiView");return t&&t.state&&t.state.name?t.state:void 0}function P(e,r){var n=["location","inherit","reload","absolute"];return{restrict:"A",require:["?^uiSrefActive","?^uiSrefActiveEq"],link:function(a,i,o,l){var s=S(o.uiSref,e.current.name),c=null,u=I(i)||e.$current,p="[object SVGAnimatedString]"===Object.prototype.toString.call(i.prop("href"))?"xlink:href":"href",f=null,d="A"===i.prop("tagName").toUpperCase(),m="FORM"===i[0].nodeName,h=m?"action":p,v=!0,$={relative:u,inherit:!0},y=a.$eval(o.uiSrefOpts)||{};t.forEach(n,function(e){e in y&&($[e]=y[e])});var g=function(r){if(r&&(c=t.copy(r)),v){f=e.href(s.state,c,$);var n=l[1]||l[0];return n&&n.$$addStateInfo(s.state,c),null===f?(v=!1,!1):void o.$set(h,f)}};s.paramExpr&&(a.$watch(s.paramExpr,function(e,t){e!==c&&g(e)},!0),c=t.copy(a.$eval(s.paramExpr))),g(),m||i.bind("click",function(t){if(!((t.which||t.button)>1||t.ctrlKey||t.metaKey||t.shiftKey||i.attr("target"))){var n=r(function(){e.go(s.state,c,$)});t.preventDefault();var a=d&&!f?1:0;t.preventDefault=function(){a--<=0&&r.cancel(n)}}})}}}function x(e,t,r){return{restrict:"A",controller:["$scope","$element","$attrs",function(t,n,a){function i(){o()?n.addClass(s):n.removeClass(s)}function o(){for(var e=0;e<c.length;e++)if(l(c[e].state,c[e].params))return!0;return!1}function l(t,r){return void 0!==a.uiSrefActiveEq?e.is(t.name,r):e.includes(t.name,r)}var s,c=[];s=r(a.uiSrefActiveEq||a.uiSrefActive||"",!1)(t),this.$$addStateInfo=function(t,r){var a=e.get(t,I(n));c.push({state:a||{name:t},params:r}),i()},t.$on("$stateChangeSuccess",i)}]}}function R(e){var t=function(t){return e.is(t)};return t.$stateful=!0,t}function D(e){var t=function(t){return e.includes(t)};return t.$stateful=!0,t}var j=t.isDefined,O=t.isFunction,k=t.isString,q=t.isObject,U=t.isArray,F=t.forEach,T=t.extend,V=t.copy;t.module("ui.router.util",["ng"]),t.module("ui.router.router",["ui.router.util"]),t.module("ui.router.state",["ui.router.router","ui.router.util"]),t.module("ui.router",["ui.router.state"]),t.module("ui.router.compat",["ui.router"]),h.$inject=["$q","$injector"],t.module("ui.router.util").service("$resolve",h),v.$inject=["$http","$templateCache","$injector"],t.module("ui.router.util").service("$templateFactory",v);var Y;$.prototype.concat=function(e,t){var r={caseInsensitive:Y.caseInsensitive(),strict:Y.strictMode(),squash:Y.defaultSquashPolicy()};return new $(this.sourcePath+e+this.sourceSearch,T(r,t),this)},$.prototype.toString=function(){return this.source},$.prototype.exec=function(e,t){var r=this.regexp.exec(e);if(!r)return null;t=t||{};var n,a,i,o=this.parameters(),l=o.length,s=this.segments.length-1,c={};if(s!==r.length-1)throw new Error("Unbalanced capture group in route '"+this.source+"'");for(n=0;s>n;n++){i=o[n];var u=this.params[i],p=r[n+1];for(a=0;a<u.replace;a++)u.replace[a].from===p&&(p=u.replace[a].to);p&&!0===u.array&&(p=function(e){function t(e){return e.split("").reverse().join("")}function r(e){return e.replace(/\\-/g,"-")}return m(m(t(e).split(/-(?!\\)/),t),r).reverse()}(p)),c[i]=u.value(p)}for(;l>n;n++)i=o[n],c[i]=this.params[i].value(t[i]);return c},$.prototype.parameters=function(e){return j(e)?this.params[e]||null:this.$$paramNames},$.prototype.validates=function(e){return this.params.$$validates(e)},$.prototype.format=function(e){function t(e){return encodeURIComponent(e).replace(/-/g,function(e){return"%5C%"+e.charCodeAt(0).toString(16).toUpperCase()})}e=e||{};var r=this.segments,n=this.parameters(),a=this.params;if(!this.validates(e))return null;var i,o=!1,l=r.length-1,s=n.length,c=r[0];for(i=0;s>i;i++){var u=l>i,p=n[i],f=a[p],d=f.value(e[p]),h=f.isOptional&&f.type.equals(f.value(),d),v=!!h&&f.squash,$=f.type.encode(d);if(u){var y=r[i+1];if(!1===v)null!=$&&(c+=U($)?m($,t).join("-"):encodeURIComponent($)),c+=y;else if(!0===v){var g=c.match(/\/$/)?/\/?(.*)/:/(.*)/;c+=y.match(g)[1]}else k(v)&&(c+=v+y)}else{if(null==$||h&&!1!==v)continue;U($)||($=[$]),$=m($,encodeURIComponent).join("&"+p+"="),c+=(o?"&":"?")+p+"="+$,o=!0}}return c},y.prototype.is=function(e,t){return!0},y.prototype.encode=function(e,t){return e},y.prototype.decode=function(e,t){return e},y.prototype.equals=function(e,t){return e==t},y.prototype.$subPattern=function(){var e=this.pattern.toString();return e.substr(1,e.length-2)},y.prototype.pattern=/.*/,y.prototype.toString=function(){return"{Type:"+this.name+"}"},y.prototype.$normalize=function(e){return this.is(e)?e:this.decode(e)},y.prototype.$asArray=function(e,t){function n(e,t){function n(e,t){return function(){return e[t].apply(e,arguments)}}function a(e){return U(e)?e:j(e)?[e]:[]}function i(e){switch(e.length){case 0:return r;case 1:return"auto"===t?e[0]:e;default:return e}}function o(e){return!e}function l(e,t){return function(r){r=a(r);var n=m(r,e);return!0===t?0===d(n,o).length:i(n)}}this.encode=l(n(e,"encode")),this.decode=l(n(e,"decode")),this.is=l(n(e,"is"),!0),this.equals=function(e){return function(t,r){var n=a(t),i=a(r);if(n.length!==i.length)return!1;for(var o=0;o<n.length;o++)if(!e(n[o],i[o]))return!1;return!0}}(n(e,"equals")),this.pattern=e.pattern,this.$normalize=l(n(e,"$normalize")),this.name=e.name,this.$arrayMode=t}if(!e)return this;if("auto"===e&&!t)throw new Error("'auto' array mode is for query parameters only");return new n(this,e)},t.module("ui.router.util").provider("$urlMatcherFactory",g),t.module("ui.router.util").run(["$urlMatcherFactory",function(e){}]),w.$inject=["$locationProvider","$urlMatcherFactoryProvider"],t.module("ui.router.router").provider("$urlRouter",w),b.$inject=["$urlRouterProvider","$urlMatcherFactoryProvider"],t.module("ui.router.state").value("$stateParams",{}).provider("$state",b),C.$inject=[],t.module("ui.router.state").provider("$view",C),t.module("ui.router.state").provider("$uiViewScroll",A),_.$inject=["$state","$injector","$uiViewScroll","$interpolate"],M.$inject=["$compile","$controller","$state","$interpolate"],t.module("ui.router.state").directive("uiView",_),t.module("ui.router.state").directive("uiView",M),P.$inject=["$state","$timeout"],x.$inject=["$state","$stateParams","$interpolate"],t.module("ui.router.state").directive("uiSref",P).directive("uiSrefActive",x).directive("uiSrefActiveEq",x),R.$inject=["$state"],D.$inject=["$state"],t.module("ui.router.state").filter("isState",R).filter("includedByState",D)}(window,window.angular),define("appraisals/app",["appraisals/utils/routes","common/angular","common/angularBootstrap","common/ui-select","common/modules/dialog","common/modules/directives","common/modules/xeditable-civi","common/filters/angular-date/format-date","common/services/angular-date/date-format","common/directives/loading","appraisals/controllers/appraisals-ctrl","appraisals/controllers/appraisals-dashboard-ctrl","appraisals/controllers/appraisal-cycle-ctrl","appraisals/controllers/modals/basic-modal-ctrl","appraisals/controllers/modals/appraisal-cycle-modal-ctrl","appraisals/controllers/modals/access-settings-modal-ctrl","appraisals/controllers/modals/edit-dates-modal-ctrl","appraisals/controllers/modals/add-contacts-modal-ctrl","appraisals/controllers/modals/view-cycle-modal-ctrl","appraisals/controllers/modals/send-notification-reminder-modal-ctrl","appraisals/controllers/modals/notification-recipients-modal-ctrl","appraisals/directives/show-more","appraisals/directives/grades-chart","appraisals/models/appraisal","appraisals/models/appraisal-cycle","appraisals/models/instances/appraisal-instance","appraisals/models/instances/appraisal-cycle-instance","appraisals/vendor/ui-router"],function(e,t){return t.module("appraisals",["ngAnimate","ngResource","ui.router","ui.bootstrap","common.angularDate","common.dialog","common.directives","appraisals.controllers","appraisals.directives","appraisals.models","ui.select","xeditable-civi"]).config(["$stateProvider","$urlRouterProvider","$resourceProvider","$httpProvider","$logProvider",function(t,r,n,a,i){i.debugEnabled(!0),n.defaults.stripTrailingSlashes=!1,a.defaults.headers.common["X-Requested-With"]="XMLHttpRequest",e(r,t)}]).run(["$log","editableOptions","editableThemes",function(e,t,r){e.debug("app.run"),t.theme="bs3"}]),t}),function(){var e=CRM.vars.appraisals.baseURL+"/js/src/appraisals";require.config({urlArgs:"bust="+(new Date).getTime(),paths:{appraisals:e,"appraisals/vendor/ui-router":e+"/vendor/angular-ui-router.min"}}),require(["appraisals/app"],function(e){e.bootstrap(document.querySelector("[data-appraisals-app]"),["appraisals"])})}(require);
//# sourceMappingURL=/sites/all/modules/civicrm/tools/extensions/civihr/uk.co.compucorp.civicrm.appraisals/appraisals.min.js.map