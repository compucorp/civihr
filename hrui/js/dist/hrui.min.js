!function(t,o){function n(o){o?(t(".crm-summary-contactname-block").removeClass("crm-summary-contactname-block-without-contract"),o.position&&t(".crm-contact-detail-position").html("<strong>Position:</strong> "+o.position),o.location&&t(".crm-contact-detail-location").html("<strong>Normal place of work:</strong> "+o.location)):(t(".crm-summary-contactname-block").addClass("crm-summary-contactname-block-without-contract"),t(".crm-contact-detail-position").html(""),t(".crm-contact-detail-location").html(""),c(null))}function c(o){o&&o.departments&&o.departments.length>0?t(".crm-contact-detail-departments").html("<strong>Department:</strong> "+o.departments.join(", ")):t(".crm-contact-detail-departments").html("")}t(document).on("crmLoad",function(o){t(".crm-inline-edit").one("DOMSubtreeModified",function(){var o=t(this).find("form");1===o.length&&o.find("label").each(function(){var o=t(this),n=o.attr("for");t("#"+n).attr("placeholder",o.text())})})}).on("updateContactHeader",function(t,o){void 0!==o.contract&&n(o.contract),void 0!==o.roles&&c(o.roles)})}(CRM.$,CRM._);
!function(t,e){function a(){var e=t(".crm-link-home");_(e,d(e,C(e)))}function n(){t.ajax("/civicrm/hrcore/usermenu?snippet=4",{dataType:"html",success:function(t){f(t,"civihr-menu")}})}function o(){if(CRM.cid&&CRM.hideGId){var e=t(".Inline_Custom_Data");e.appendTo(t("#contactinfo-block").parent("div").parent("div")),e.removeClass("crm-collapsible"),e.removeClass("collapsed"),e.addClass("crm-summary-block"),t(".Inline_Custom_Data div.collapsible-title").css({display:"none"}),t(".Inline_Custom_Data div.crm-summary-block").css({display:"block"})}t("#customFields").length<1&&(t("#Inline_Custom_Data label").each(function(){t("#nick_name").parent().after('<td id="customFields"></td>');var e=t(this).attr("for"),a=t("#"+e).detach();t("#customFields").append(t(this)),t("#customFields").append(a)}),t("#Inline_Custom_Data").remove())}function i(e){1===t(e).length&&t(e).on("change",u)}function c(){t(".CRM_HRRecruitment_Form_Application").addClass("crm-form-block"),t(".CRM_HRRecruitment_Form_Application .crm-profile-name-application_profile").addClass("form-layout-compressed")}function r(e){"contactForm"!==CRM.formName&&"viewSummary"!==CRM.pageName||(t(".crm-contact-job_title",".crm-summary-contactinfo-block").length&&t(".crm-contact-tabs-list #tab_summary a",e.target).text("Personal Details"),o(e.target),h(e.target))}function m(){1===t(".CRM_HRRecruitment_Form_HRVacancy").length&&(p(t('label[for="start_date"]').parents("tr")),p(t('label[for="end_date"]').parents("tr")),t('[name="entryURL"]').val().indexOf(";template=1")>-1&&t(t(".CRM_HRRecruitment_Form_HRVacancy tbody").get(0)).addClass("CRM_HRRecruitment_Form_HRVacancy_Template"))}function l(){t("#activityCustomData").attr("colspan",3),t("#crm-activity-view-table .crm-case-activity-view-Client .label").html("Contact"),t("span.crm-frozen-field",".crm-profile-name-hrident_tab").closest("div").parent("div").hide(),t(".crm-accordion-header.crm-master-accordion-header").on("click",function(){window.setTimeout(function(){Array.prototype.forEach.call(document.querySelectorAll(".listing-box"),function(t){Ps.initialize(t)})},0)})}function s(){t("INPUT#contact_source").parent("td").children("a").click(function(){t("#crm-notification-container .crm-help .notify-content").remove(),t("#crm-notification-container .crm-help p").length&&t("#crm-notification-container .crm-help p").remove(),t("#crm-notification-container .crm-help").append("<p>Source is a useful field where data has been migrated to CiviHR from one or a number of other legacy systems. The Source field will indicate which legacy system the contact has come from.</p>")})}function d(e,a){return t("li > a",e).first().text("Home").wrapInner('<span class="menumain-label">').prepend(a)}function f(e,a){var n=t(e),o=t("<div>");o.attr("id",a),o.append(t("#civicrm-menu")),o.append(n),o.insertAfter("#page")}function u(){var e=t(this)[0].files[0];t("#js-uploaded-file").remove(),void 0!==e&&(t(this).after('<span id="js-uploaded-file" class="uploaded-file">'+e.name+' <span class="uploaded-file-icon-trash"><i class="fa fa-trash-o"></i> Remove</span>'),t(".uploaded-file-icon-trash").on("click",v))}function p(t){t.find("label").attr("for",t.find(".crm-form-date").attr("id"))}function h(e){t("div.crm-contact-current_employer, div.crm-contact-job_title",".crm-summary-contactinfo-block").parent("div.crm-summary-row").hide(),t("form#ContactInfo input#employer_id, form#ContactInfo input#job_title",e).closest("div.crm-summary-row").hide(),t("input#employer_id, input#job_title","form#Contact").parent("td").hide(),t(".HRJobContract_Summary",e).insertBefore(t(".crm-summary-contactinfo-block")),t("div.email-signature, td#Email-Bulkmail-html","form#Contact").hide(),t("#Email-Primary","form#Contact").prev("td").prev("td").hide(),t("td#Email-Bulkmail-html, #Email-Primary","form#Contact").prev("td").hide(),t(".crm-demographics-accordion","form#Contact").insertAfter(t(".crm-contactDetails-accordion")),t("tr#Phone_Block_2","form#Contact").length<1&&t("#addPhone").click()}function v(){var e=t("#js-uploaded-file").parent().find('input[type="file"]');t("#js-uploaded-file").remove(),e.val("")}function _(t,e){t.off().find("#civicrm-home").before(e).remove()}function C(e){return t(".crm-logo-sm",e).addClass("chr_logo chr_logo--default-color").removeClass("crm-logo-sm").wrap('<span class="menumain-icon">').parent()}function y(){t(".menumain").not(".crm-Self_Service_Portal").hover(function(){t(this).addClass("activetarget")},function(){t(this).removeClass("activetarget")})}function b(){t("#root-menu-div .menu-item-arrow").each(function(e){var a=t(this);a.before('<i class="fa fa-caret-right menu-item-arrow"></i>'),a.remove()})}t(document).on("crmLoad",function(t){i("input[type='file']"),m(),r(t),l(),s()}).ready(function(){n(),a(),c(),b(),y()})}(CRM.$,CRM._);
!function(t){"use strict";var n=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;t.fn.attrchange=function(t){if(n){var e={subtree:!1,attributes:!0},i=new n(function(n){n.forEach(function(n){t.call(n.target,n)})});return this.each(function(){i.observe(this,e)})}}}(CRM.$);
!function(t){"use strict";var i=t("body");i.on("click",".btn-slide",function(){function n(){t(".civihr-popup").remove(),i.removeClass("civihr-popup-open")}function a(){var n=s.offset(),a=d.clone(!0).appendTo(i).addClass("civihr-popup").attr("id",r.id).addClass(t(r).attr("class"));a.css({left:+n.left-(a.width()-s.outerWidth()),top:+n.top+s.outerHeight()}),a.show(),o(a)}function c(){s.data("attrchange-is-on")||(s.data("attrchange-is-on",!0),s.attrchange(function(){s.hasClass("btn-slide-active")||n()}))}function o(i){i.find("a").click(function(){var i=t(this).parent().index();d.find("li:nth("+i+") a").click()})}function e(){n(),a(),i.addClass("civihr-popup-open")}var s=t(this),r=s.closest(".crm-entity")[0],d=s.children("ul.panel");!function(){e(),c()}()})}(CRM.$);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbnRhY3QuanMiLCJocnVpLmpzIiwiY2l2aWhyLXBvcHVwL2F0dHJjaGFuZ2UuanMiLCJjaXZpaHItcG9wdXAvY2l2aWhyLXBvcHVwLmpzIl0sIm5hbWVzIjpbIiQiLCJfIiwidXBkYXRlQ29udGFjdEhlYWRlckNvbnRyYWN0RGV0YWlscyIsImNvbnRyYWN0IiwicmVtb3ZlQ2xhc3MiLCJwb3NpdGlvbiIsImh0bWwiLCJsb2NhdGlvbiIsImFkZENsYXNzIiwidXBkYXRlQ29udGFjdEhlYWRlclJvbGVzRGV0YWlscyIsInJvbGVzIiwiZGVwYXJ0bWVudHMiLCJsZW5ndGgiLCJqb2luIiwiZG9jdW1lbnQiLCJvbiIsImUiLCJvbmUiLCIkZm9ybSIsInRoaXMiLCJmaW5kIiwiZWFjaCIsIiRsYWJlbCIsImlkIiwiYXR0ciIsInRleHQiLCJkYXRhIiwiQ1JNIiwiYW1lbmRBcHBMb2dvTWVudUl0ZW0iLCIkbWVudUl0ZW0iLCJyZW1vdmVMb2dvU3ViTWVudUFuZEtlZXBPbmx5SG9tZUxpbmsiLCJjdXN0b21pemVIb21lTGlua0luTG9nb01lbnVJdGVtIiwic3dhcEFuZFdyYXBBcHBMb2dvIiwiYWRkVXNlck1lbnVUb01haW5NZW51IiwiYWpheCIsImRhdGFUeXBlIiwic3VjY2VzcyIsIm1lbnVNYXJrdXAiLCJpbmplY3RVc2VyTWVudUluQU1haW5NZW51V3JhcHBlciIsImFkZEdvdmVybm1lbnRJZEZpZWxkIiwiY2lkIiwiaGlkZUdJZCIsImlubGluZURhdGFCbG9jayIsImFwcGVuZFRvIiwicGFyZW50IiwiY3NzIiwiZGlzcGxheSIsImFmdGVyIiwibm9kZUlEIiwiY3VzdG9tRmllbGQiLCJkZXRhY2giLCJhcHBlbmQiLCJyZW1vdmUiLCJhZGRVcGxvYWRGaWxlTGlzdGVuZXIiLCJzZWxlY3RvciIsImluc2VydEZpbGUiLCJhbWVuZEFwcGxpY2F0aW9uRm9ybSIsImFtZW5kQ29udGFjdFBhZ2VBbmRGb3JtIiwiZm9ybU5hbWUiLCJwYWdlTmFtZSIsInRhcmdldCIsIm1pc2NDb250YWN0UGFnZUNoYW5nZXMiLCJhbWVuZFZhY2FuY3lGb3JtIiwibGlua0xhYmVsVG9EYXRlcGlja2VySW5wdXQiLCJwYXJlbnRzIiwidmFsIiwiaW5kZXhPZiIsImdldCIsImFwcGx5TWlzY0NoYW5nZXMiLCJjbG9zZXN0IiwiaGlkZSIsIndpbmRvdyIsInNldFRpbWVvdXQiLCJBcnJheSIsInByb3RvdHlwZSIsImZvckVhY2giLCJjYWxsIiwicXVlcnlTZWxlY3RvckFsbCIsImVsZW1lbnQiLCJQcyIsImluaXRpYWxpemUiLCJjaGFuZ2VDb250YWN0U291cmNlRmllbGRIZWxwVGV4dCIsImNoaWxkcmVuIiwiY2xpY2siLCIkYXBwTG9nbyIsImZpcnN0Iiwid3JhcElubmVyIiwicHJlcGVuZCIsIndyYXBwZXJJZCIsIiRtZW51TWFya3VwIiwiJG1lbnVXcmFwcGVyIiwiaW5zZXJ0QWZ0ZXIiLCJmaWxlTmFtZSIsImZpbGVzIiwidW5kZWZpbmVkIiwibmFtZSIsInJlbW92ZUZpbGUiLCIkbGluZSIsImluc2VydEJlZm9yZSIsInByZXYiLCIkaW5wdXQiLCIkaG9tZUxpbmsiLCJvZmYiLCJiZWZvcmUiLCJ3cmFwIiwidG9nZ2xlQWN0aXZlQ2xhc3NPbkhvdmVyT25BbnlNYWluTWVudUl0ZW0iLCJub3QiLCJob3ZlciIsInVzZUZvbnRBd2Vzb21lQXJyb3dzSW5TdWJNZW51SXRlbXMiLCIkZWxlbWVudCIsIiRhcnJvdyIsInJlYWR5IiwiTXV0YXRpb25PYnNlcnZlciIsIldlYktpdE11dGF0aW9uT2JzZXJ2ZXIiLCJNb3pNdXRhdGlvbk9ic2VydmVyIiwiZm4iLCJhdHRyY2hhbmdlIiwiY2FsbGJhY2siLCJvcHRpb25zIiwic3VidHJlZSIsImF0dHJpYnV0ZXMiLCJvYnNlcnZlciIsIm11dGF0aW9ucyIsIm9ic2VydmUiLCIkYm9keSIsImNsb3NlUG9wdXBQYW5lbHMiLCJjcmVhdGVQb3B1cENsb25lIiwiYnV0dG9uT2Zmc2V0IiwiJGJ1dHRvbiIsIm9mZnNldCIsIiRjbG9uZSIsIiRwb3B1cCIsImNsb25lIiwiJGNsb3Nlc3RFbnRpdHkiLCJsZWZ0Iiwid2lkdGgiLCJvdXRlcldpZHRoIiwidG9wIiwib3V0ZXJIZWlnaHQiLCJzaG93IiwibWFwQ2xvbmVDbGlja0V2ZW50c1RvT3JpZ2luIiwibGlzdGVuVG9Nb3VzZU91dEV2ZW50IiwiaGFzQ2xhc3MiLCJhY3Rpb25JbmRleCIsImluZGV4Iiwib3BlblBvcHVwUGFuZWwiXSwibWFwcGluZ3MiOiJDQUFDLFNBQVVBLEVBQUdDLEdBK0JaLFFBQVNDLEdBQW1DQyxHQUN0Q0EsR0FDRkgsRUFBRSxrQ0FBa0NJLFlBQVksa0RBRTVDRCxFQUFTRSxVQUNYTCxFQUFFLGdDQUFnQ00sS0FBSyw4QkFBK0JILEVBQVNFLFVBRzdFRixFQUFTSSxVQUNYUCxFQUFFLGdDQUFnQ00sS0FBSywwQ0FBMkNILEVBQVNJLFlBRzdGUCxFQUFFLGtDQUFrQ1EsU0FBUyxrREFDN0NSLEVBQUUsZ0NBQWdDTSxLQUFLLElBQ3ZDTixFQUFFLGdDQUFnQ00sS0FBSyxJQUV2Q0csRUFBZ0MsT0FTcEMsUUFBU0EsR0FBZ0NDLEdBQ25DQSxHQUFTQSxFQUFNQyxhQUFlRCxFQUFNQyxZQUFZQyxPQUFTLEVBQzNEWixFQUFFLG1DQUFtQ00sS0FBSyxnQ0FBa0NJLEVBQU1DLFlBQVlFLEtBQUssT0FFbkdiLEVBQUUsbUNBQW1DTSxLQUFLLElBMUQ5Q04sRUFBRWMsVUFDQ0MsR0FBRyxVQUFXLFNBQVNDLEdBQ3RCaEIsRUFBRSxvQkFBb0JpQixJQUFJLHFCQUFzQixXQUM5QyxHQUFJQyxHQUFRbEIsRUFBRW1CLE1BQU1DLEtBQUssT0FFSixLQUFqQkYsRUFBTU4sUUFDUk0sRUFBTUUsS0FBSyxTQUFTQyxLQUFLLFdBQ3ZCLEdBQUlDLEdBQVN0QixFQUFFbUIsTUFDWEksRUFBS0QsRUFBT0UsS0FBSyxNQUNyQnhCLEdBQUUsSUFBTXVCLEdBQUlDLEtBQUssY0FBZUYsRUFBT0csY0FLOUNWLEdBQUcsc0JBQXVCLFNBQVVDLEVBQUdVLE9BQ1QsS0FBbEJBLEVBQUt2QixVQUNkRCxF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QUcsUUFBUyxhQUFjLFdBYzlCLFFBQVM4RyxLQUNQN0gsRUFBRSxpQkFBaUJvRCxTQUNuQndFLEVBQU14SCxZQUFZLHFCQU9wQixRQUFTMEgsS0FDUCxHQUFJQyxHQUFlQyxFQUFRQyxTQUN2QkMsRUFBU0MsRUFBT0MsT0FBTSxHQUN2QnpGLFNBQVNpRixHQUNUcEgsU0FBUyxnQkFDVGdCLEtBQUssS0FBTTZHLEVBQWU5RyxJQUMxQmYsU0FBU1IsRUFBRXFJLEdBQWdCN0csS0FBSyxTQUVuQzBHLEdBQU9yRixLQUNMeUYsTUFBT1AsRUFBYU8sTUFBUUosRUFBT0ssUUFBVVAsRUFBUVEsY0FDckRDLEtBQU1WLEVBQWFVLElBQU1ULEVBQVFVLGdCQUVuQ1IsRUFBT1MsT0FDUEMsRUFBNEJWLEdBVTlCLFFBQVNXLEtBRUhiLEVBQVF0RyxLQUFLLHNCQUlqQnNHLEVBQVF0RyxLQUFLLG9CQUFvQixHQUNqQ3NHLEVBQVFaLFdBQVcsV0FFYlksRUFBUWMsU0FBUyxxQkFJckJqQixPQVlKLFFBQVNlLEdBQTZCVixHQUNwQ0EsRUFBTzlHLEtBQUssS0FBSytELE1BQU0sV0FDckIsR0FBSTRELEdBQWMvSSxFQUFFbUIsTUFBTXlCLFNBQVNvRyxPQUVuQ2IsR0FBTy9HLEtBQUssVUFBWTJILEVBQWMsT0FBTzVELFVBUWpELFFBQVM4RCxLQUNQcEIsSUFDQUMsSUFDQUYsRUFBTXBILFNBQVMscUJBckZqQixHQUFJd0gsR0FBVWhJLEVBQUVtQixNQUNaa0gsRUFBaUJMLEVBQVEzRCxRQUFRLGVBQWUsR0FDaEQ4RCxFQUFTSCxFQUFROUMsU0FBUyxhQUU5QixXQUNFK0QsSUFDQUosVUFrRkhsSCxJQUFJM0IiLCJmaWxlIjoiaHJ1aS5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gKCQsIF8pIHtcblxuICAkKGRvY3VtZW50KVxuICAgIC5vbignY3JtTG9hZCcsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICQoJy5jcm0taW5saW5lLWVkaXQnKS5vbmUoJ0RPTVN1YnRyZWVNb2RpZmllZCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgJGZvcm0gPSAkKHRoaXMpLmZpbmQoJ2Zvcm0nKTtcblxuICAgICAgICBpZiAoJGZvcm0ubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgJGZvcm0uZmluZCgnbGFiZWwnKS5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyICRsYWJlbCA9ICQodGhpcyk7XG4gICAgICAgICAgICB2YXIgaWQgPSAkbGFiZWwuYXR0cignZm9yJyk7XG4gICAgICAgICAgICAkKCcjJyArIGlkKS5hdHRyKCdwbGFjZWhvbGRlcicsICRsYWJlbC50ZXh0KCkpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KVxuICAgIH0pXG4gICAgLm9uKCd1cGRhdGVDb250YWN0SGVhZGVyJywgZnVuY3Rpb24gKGUsIGRhdGEpIHtcbiAgICAgIGlmICh0eXBlb2YgZGF0YS5jb250cmFjdCAhPT0gJ3VuZGVmaW5lZCcpICB7XG4gICAgICAgIHVwZGF0ZUNvbnRhY3RIZWFkZXJDb250cmFjdERldGFpbHMoZGF0YS5jb250cmFjdCk7XG4gICAgICB9XG5cbiAgICAgIGlmICh0eXBlb2YgZGF0YS5yb2xlcyAhPT0gJ3VuZGVmaW5lZCcpICB7XG4gICAgICAgIHVwZGF0ZUNvbnRhY3RIZWFkZXJSb2xlc0RldGFpbHMoZGF0YS5yb2xlcyk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgLyoqXG4gICAqIFVwZGF0ZXMgdGhlIGNvbnRhY3QgaGVhZGVyIHdpdGggdGhlIGdpdmVuIGNvbnRyYWN0IGRldGFpbHNcbiAgICpcbiAgICogQHBhcmFtICB7b2JqZWN0fSBjb250cmFjdFxuICAgKi9cbiAgZnVuY3Rpb24gdXBkYXRlQ29udGFjdEhlYWRlckNvbnRyYWN0RGV0YWlscyhjb250cmFjdCkge1xuICAgIGlmIChjb250cmFjdCkgIHtcbiAgICAgICQoJy5jcm0tc3VtbWFyeS1jb250YWN0bmFtZS1ibG9jaycpLnJlbW92ZUNsYXNzKCdjcm0tc3VtbWFyeS1jb250YWN0bmFtZS1ibG9jay13aXRob3V0LWNvbnRyYWN0Jyk7XG5cbiAgICAgIGlmIChjb250cmFjdC5wb3NpdGlvbikge1xuICAgICAgICAkKCcuY3JtLWNvbnRhY3QtZGV0YWlsLXBvc2l0aW9uJykuaHRtbCgnPHN0cm9uZz5Qb3NpdGlvbjo8L3N0cm9uZz4gJysgY29udHJhY3QucG9zaXRpb24pO1xuICAgICAgfVxuXG4gICAgICBpZiAoY29udHJhY3QubG9jYXRpb24pIHtcbiAgICAgICAgJCgnLmNybS1jb250YWN0LWRldGFpbC1sb2NhdGlvbicpLmh0bWwoJzxzdHJvbmc+Tm9ybWFsIHBsYWNlIG9mIHdvcms6PC9zdHJvbmc+ICcrIGNvbnRyYWN0LmxvY2F0aW9uKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgJCgnLmNybS1zdW1tYXJ5LWNvbnRhY3RuYW1lLWJsb2NrJykuYWRkQ2xhc3MoJ2NybS1zdW1tYXJ5LWNvbnRhY3RuYW1lLWJsb2NrLXdpdGhvdXQtY29udHJhY3QnKTtcbiAgICAgICQoJy5jcm0tY29udGFjdC1kZXRhaWwtcG9zaXRpb24nKS5odG1sKCcnKTtcbiAgICAgICQoJy5jcm0tY29udGFjdC1kZXRhaWwtbG9jYXRpb24nKS5odG1sKCcnKTtcblxuICAgICAgdXBkYXRlQ29udGFjdEhlYWRlclJvbGVzRGV0YWlscyhudWxsKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlcyB0aGUgY29udGFjdCBoZWFkZXIgd2l0aCB0aGUgZ2l2ZW4gcm9sZXMgZGV0YWlsc1xuICAgKlxuICAgKiBAcGFyYW0gIHtvYmplY3R9IGNvbnRyYWN0XG4gICAqL1xuICBmdW5jdGlvbiB1cGRhdGVDb250YWN0SGVhZGVyUm9sZXNEZXRhaWxzKHJvbGVzKSB7XG4gICAgaWYgKHJvbGVzICYmIHJvbGVzLmRlcGFydG1lbnRzICYmIHJvbGVzLmRlcGFydG1lbnRzLmxlbmd0aCA+IDApIHtcbiAgICAgICQoJy5jcm0tY29udGFjdC1kZXRhaWwtZGVwYXJ0bWVudHMnKS5odG1sKCc8c3Ryb25nPkRlcGFydG1lbnQ6PC9zdHJvbmc+ICcgKyByb2xlcy5kZXBhcnRtZW50cy5qb2luKCcsICcpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgJCgnLmNybS1jb250YWN0LWRldGFpbC1kZXBhcnRtZW50cycpLmh0bWwoJycpO1xuICAgIH1cbiAgfVxufShDUk0uJCwgQ1JNLl8pKTtcbiIsIi8qIGdsb2JhbCBQcyAqL1xuXG4vLyBDb3B5cmlnaHQgQ2l2aUNSTSBMTEMgMjAxMy4gU2VlIGh0dHA6Ly9jaXZpY3JtLm9yZy9saWNlbnNpbmdcbihmdW5jdGlvbiAoJCwgXykge1xuICAkKGRvY3VtZW50KVxuICAgIC5vbignY3JtTG9hZCcsIGZ1bmN0aW9uIChlKSB7XG4gICAgICBhZGRVcGxvYWRGaWxlTGlzdGVuZXIoXCJpbnB1dFt0eXBlPSdmaWxlJ11cIik7XG4gICAgICBhbWVuZFZhY2FuY3lGb3JtKCk7XG4gICAgICBhbWVuZENvbnRhY3RQYWdlQW5kRm9ybShlKTtcbiAgICAgIGFwcGx5TWlzY0NoYW5nZXMoKTtcbiAgICAgIGNoYW5nZUNvbnRhY3RTb3VyY2VGaWVsZEhlbHBUZXh0KCk7XG4gICAgfSlcbiAgICAucmVhZHkoZnVuY3Rpb24gKCkge1xuICAgICAgYWRkVXNlck1lbnVUb01haW5NZW51KCk7XG4gICAgICBhbWVuZEFwcExvZ29NZW51SXRlbSgpO1xuICAgICAgYW1lbmRBcHBsaWNhdGlvbkZvcm0oKTtcbiAgICAgIHVzZUZvbnRBd2Vzb21lQXJyb3dzSW5TdWJNZW51SXRlbXMoKTtcbiAgICAgIHRvZ2dsZUFjdGl2ZUNsYXNzT25Ib3Zlck9uQW55TWFpbk1lbnVJdGVtKCk7XG4gICAgfSk7XG5cbiAgLyoqXG4gICAqIEN1c3RvbWl6ZXMgdGhlIGFwcCBsb2dvIG1lbnUgaXRlbSwgc3dpdGNoaW5nIGZyb20gdGhlIENpdmlDUk0gbG9nb1xuICAgKiB0byB0aGUgQ2l2aUhSIGxvZ28sIGFuZCBtYWtpbmcgdGhlIGl0ZW0gYSBkaXJlY3QgbGluayBpbnN0ZWFkIG9mIGFcbiAgICogdG9nZ2xlIGZvciBhIHN1YiBtZW51IGRyb3Bkb3duXG4gICAqL1xuICBmdW5jdGlvbiBhbWVuZEFwcExvZ29NZW51SXRlbSAoKSB7XG4gICAgdmFyICRtZW51SXRlbSA9ICQoJy5jcm0tbGluay1ob21lJyk7XG4gICAgdmFyICR3cmFwcGVkTG9nbyA9IHN3YXBBbmRXcmFwQXBwTG9nbygkbWVudUl0ZW0pO1xuICAgIHZhciAkY3VzdG9tSG9tZUxpbmsgPSBjdXN0b21pemVIb21lTGlua0luTG9nb01lbnVJdGVtKCRtZW51SXRlbSwgJHdyYXBwZWRMb2dvKTtcblxuICAgIHJlbW92ZUxvZ29TdWJNZW51QW5kS2VlcE9ubHlIb21lTGluaygkbWVudUl0ZW0sICRjdXN0b21Ib21lTGluayk7XG4gIH1cblxuICAvKipcbiAgICogQWRkcyB0aGUgdXNlciBtZW51IGJ5IGZldGNoaW5nIGl0IGZyb20gdGhlIGhyY29yZSBleHRlbnNpb25cbiAgICovXG4gIGZ1bmN0aW9uIGFkZFVzZXJNZW51VG9NYWluTWVudSAoKSB7XG4gICAgJC5hamF4KCcvY2l2aWNybS9ocmNvcmUvdXNlcm1lbnU/c25pcHBldD00Jywge1xuICAgICAgZGF0YVR5cGU6ICdodG1sJyxcbiAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChtZW51TWFya3VwKSB7XG4gICAgICAgIGluamVjdFVzZXJNZW51SW5BTWFpbk1lbnVXcmFwcGVyKG1lbnVNYXJrdXAsICdjaXZpaHItbWVudScpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZHMgdGhlIEdvdmVybm1lbnQgSUQgZmllbGQgb24gdGhlIFBlcnNvbmFsIERldGFpbHMgcGFnZSBhbmQgb24gdGhlIEVkaXRcbiAgICogQ29udGFjdCBmb3JtLlxuICAgKi9cbiAgZnVuY3Rpb24gYWRkR292ZXJubWVudElkRmllbGQgKCkge1xuICAgIC8vIFVwZGF0ZXMgUGVyc29uYWwgRGV0YWlscyBQYWdlXG4gICAgaWYgKENSTS5jaWQgJiYgQ1JNLmhpZGVHSWQpIHtcbiAgICAgIHZhciBpbmxpbmVEYXRhQmxvY2sgPSAkKCcuSW5saW5lX0N1c3RvbV9EYXRhJyk7XG5cbiAgICAgIGlubGluZURhdGFCbG9jay5hcHBlbmRUbygkKCcjY29udGFjdGluZm8tYmxvY2snKS5wYXJlbnQoJ2RpdicpLnBhcmVudCgnZGl2JykpO1xuICAgICAgaW5saW5lRGF0YUJsb2NrLnJlbW92ZUNsYXNzKCdjcm0tY29sbGFwc2libGUnKTtcbiAgICAgIGlubGluZURhdGFCbG9jay5yZW1vdmVDbGFzcygnY29sbGFwc2VkJyk7XG4gICAgICBpbmxpbmVEYXRhQmxvY2suYWRkQ2xhc3MoJ2NybS1zdW1tYXJ5LWJsb2NrJyk7XG5cbiAgICAgICQoJy5JbmxpbmVfQ3VzdG9tX0RhdGEgZGl2LmNvbGxhcHNpYmxlLXRpdGxlJykuY3NzKHtkaXNwbGF5OiAnbm9uZSd9KTtcbiAgICAgICQoJy5JbmxpbmVfQ3VzdG9tX0RhdGEgZGl2LmNybS1zdW1tYXJ5LWJsb2NrJykuY3NzKHtkaXNwbGF5OiAnYmxvY2snfSk7XG4gICAgfVxuXG4gICAgLy8gVXBkYXRlcyBFZGl0IENvbnRhY3QgRm9ybVxuICAgIGlmICgkKCcjY3VzdG9tRmllbGRzJykubGVuZ3RoIDwgMSkge1xuICAgICAgJCgnI0lubGluZV9DdXN0b21fRGF0YSBsYWJlbCcpLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICAkKCcjbmlja19uYW1lJykucGFyZW50KCkuYWZ0ZXIoJzx0ZCBpZD1cImN1c3RvbUZpZWxkc1wiPjwvdGQ+Jyk7XG4gICAgICAgIHZhciBub2RlSUQgPSAkKHRoaXMpLmF0dHIoJ2ZvcicpO1xuICAgICAgICB2YXIgY3VzdG9tRmllbGQgPSAkKCcjJyArIG5vZGVJRCkuZGV0YWNoKCk7XG4gICAgICAgICQoJyNjdXN0b21GaWVsZHMnKS5hcHBlbmQoJCh0aGlzKSk7XG4gICAgICAgICQoJyNjdXN0b21GaWVsZHMnKS5hcHBlbmQoY3VzdG9tRmllbGQpO1xuICAgICAgfSk7XG5cbiAgICAgICQoJyNJbmxpbmVfQ3VzdG9tX0RhdGEnKS5yZW1vdmUoKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQWRkIGFuIGV2ZW50IGxpc3RlbmVyIG9uIGlucHV0W3R5cGU9XCJmaWxlXCJdXG4gICAqIEBwYXJhbSB7alF1ZXJ5IE9iamVjdH0gc2VsZWN0b3IgW3NlbGVjdG9yIGZyb20gaW5wdXQgZmlsZV1cbiAgICovXG4gIGZ1bmN0aW9uIGFkZFVwbG9hZEZpbGVMaXN0ZW5lciAoc2VsZWN0b3IpIHtcbiAgICBpZiAoJChzZWxlY3RvcikubGVuZ3RoID09PSAxKSB7XG4gICAgICAkKHNlbGVjdG9yKS5vbignY2hhbmdlJywgaW5zZXJ0RmlsZSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEFtZW5kcyB0aGUgYXBwbGljYXRpb24gZm9ybVxuICAgKi9cbiAgZnVuY3Rpb24gYW1lbmRBcHBsaWNhdGlvbkZvcm0gKCkge1xuICAgICQoJy5DUk1fSFJSZWNydWl0bWVudF9Gb3JtX0FwcGxpY2F0aW9uJykuYWRkQ2xhc3MoJ2NybS1mb3JtLWJsb2NrJyk7XG4gICAgJCgnLkNSTV9IUlJlY3J1aXRtZW50X0Zvcm1fQXBwbGljYXRpb24gLmNybS1wcm9maWxlLW5hbWUtYXBwbGljYXRpb25fcHJvZmlsZScpLmFkZENsYXNzKCdmb3JtLWxheW91dC1jb21wcmVzc2VkJyk7XG4gIH1cblxuICAvKipcbiAgICogQW1lbmRzIHRoZSBjb250YWN0IHBhZ2UgYW5kIHRoZSBjb250YWN0IGZvcm1cbiAgICovXG4gIGZ1bmN0aW9uIGFtZW5kQ29udGFjdFBhZ2VBbmRGb3JtIChlKSB7XG4gICAgaWYgKENSTS5mb3JtTmFtZSA9PT0gJ2NvbnRhY3RGb3JtJyB8fCBDUk0ucGFnZU5hbWUgPT09ICd2aWV3U3VtbWFyeScpIHtcbiAgICAgIC8vIFJlbmFtZSBcIlN1bW1hcnlcIiB0YWIgdG8gXCJQZXJzb25hbCBEZXRhaWxzXCJcbiAgICAgIC8vIEhhY2sgdG8gY2hlY2sgY29udGFjdCB0eXBlIC0gVGhpcyBmaWVsZCBvbmx5IGFwcGVhcnMgZm9yIGluZGl2aWR1YWxzXG4gICAgICBpZiAoJCgnLmNybS1jb250YWN0LWpvYl90aXRsZScsICcuY3JtLXN1bW1hcnktY29udGFjdGluZm8tYmxvY2snKS5sZW5ndGgpIHtcbiAgICAgICAgJCgnLmNybS1jb250YWN0LXRhYnMtbGlzdCAjdGFiX3N1bW1hcnkgYScsIGUudGFyZ2V0KS50ZXh0KCdQZXJzb25hbCBEZXRhaWxzJyk7XG4gICAgICB9XG5cbiAgICAgIGFkZEdvdmVybm1lbnRJZEZpZWxkKGUudGFyZ2V0KTtcbiAgICAgIG1pc2NDb250YWN0UGFnZUNoYW5nZXMoZS50YXJnZXQpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBBbWVuZHMgdGhlIHZhY2FuY3kgZm9ybVxuICAgKi9cbiAgZnVuY3Rpb24gYW1lbmRWYWNhbmN5Rm9ybSAoKSB7XG4gICAgaWYgKCQoJy5DUk1fSFJSZWNydWl0bWVudF9Gb3JtX0hSVmFjYW5jeScpLmxlbmd0aCA9PT0gMSkge1xuICAgICAgbGlua0xhYmVsVG9EYXRlcGlja2VySW5wdXQoJCgnbGFiZWxbZm9yPVwic3RhcnRfZGF0ZVwiXScpLnBhcmVudHMoJ3RyJykpO1xuICAgICAgbGlua0xhYmVsVG9EYXRlcGlja2VySW5wdXQoJCgnbGFiZWxbZm9yPVwiZW5kX2RhdGVcIl0nKS5wYXJlbnRzKCd0cicpKTtcblxuICAgICAgLy8gQWRkIGEgY2xhc3MgdG8gaWRlbnRpZnkgdGhlIGZvcm0gJ05ldyBWYWNhbmN5IFRlbXBsYXRlJ1xuICAgICAgaWYgKCQoJ1tuYW1lPVwiZW50cnlVUkxcIl0nKS52YWwoKS5pbmRleE9mKCc7dGVtcGxhdGU9MScpID4gLTEpIHtcbiAgICAgICAgJCgkKCcuQ1JNX0hSUmVjcnVpdG1lbnRfRm9ybV9IUlZhY2FuY3kgdGJvZHknKS5nZXQoMCkpLmFkZENsYXNzKCdDUk1fSFJSZWNydWl0bWVudF9Gb3JtX0hSVmFjYW5jeV9UZW1wbGF0ZScpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBBcHBsaWVzIG1pc2NlbGxhbmVvdXMgVUkgY2hhbmdlc1xuICAgKi9cbiAgZnVuY3Rpb24gYXBwbHlNaXNjQ2hhbmdlcyAoKSB7XG4gICAgJCgnI2FjdGl2aXR5Q3VzdG9tRGF0YScpLmF0dHIoJ2NvbHNwYW4nLCAzKTtcbiAgICAkKCcjY3JtLWFjdGl2aXR5LXZpZXctdGFibGUgLmNybS1jYXNlLWFjdGl2aXR5LXZpZXctQ2xpZW50IC5sYWJlbCcpLmh0bWwoJ0NvbnRhY3QnKTtcbiAgICAkKCdzcGFuLmNybS1mcm96ZW4tZmllbGQnLCAnLmNybS1wcm9maWxlLW5hbWUtaHJpZGVudF90YWInKS5jbG9zZXN0KCdkaXYnKS5wYXJlbnQoJ2RpdicpLmhpZGUoKTtcblxuICAgICQoJy5jcm0tYWNjb3JkaW9uLWhlYWRlci5jcm0tbWFzdGVyLWFjY29yZGlvbi1oZWFkZXInKS5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgICB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmxpc3RpbmctYm94JyksIGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgICAgICAgUHMuaW5pdGlhbGl6ZShlbGVtZW50KTtcbiAgICAgICAgfSk7XG4gICAgICB9LCAwKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGFuZ2VzIG9mIHNvcmNlIGhlbHAgdGV4dFxuICAgKi9cbiAgZnVuY3Rpb24gY2hhbmdlQ29udGFjdFNvdXJjZUZpZWxkSGVscFRleHQgKCkge1xuICAgICQoJ0lOUFVUI2NvbnRhY3Rfc291cmNlJykucGFyZW50KCd0ZCcpLmNoaWxkcmVuKCdhJykuY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICAgJCgnI2NybS1ub3RpZmljYXRpb24tY29udGFpbmVyIC5jcm0taGVscCAubm90aWZ5LWNvbnRlbnQnKS5yZW1vdmUoKTtcblxuICAgICAgaWYgKCQoJyNjcm0tbm90aWZpY2F0aW9uLWNvbnRhaW5lciAuY3JtLWhlbHAgcCcpLmxlbmd0aCkge1xuICAgICAgICAkKCcjY3JtLW5vdGlmaWNhdGlvbi1jb250YWluZXIgLmNybS1oZWxwIHAnKS5yZW1vdmUoKTtcbiAgICAgIH1cblxuICAgICAgJCgnI2NybS1ub3RpZmljYXRpb24tY29udGFpbmVyIC5jcm0taGVscCcpLmFwcGVuZCgnPHA+U291cmNlIGlzIGEgdXNlZnVsIGZpZWxkIHdoZXJlIGRhdGEgaGFzIGJlZW4gbWlncmF0ZWQgdG8gQ2l2aUhSIGZyb20gb25lIG9yIGEgbnVtYmVyIG9mIG90aGVyIGxlZ2FjeSBzeXN0ZW1zLiBUaGUgU291cmNlIGZpZWxkIHdpbGwgaW5kaWNhdGUgd2hpY2ggbGVnYWN5IHN5c3RlbSB0aGUgY29udGFjdCBoYXMgY29tZSBmcm9tLjwvcD4nKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBGaW5kcyB0aGUgb3JpZ2luYWwgbGluayB0byB0aGUgaG9tZXBhZ2UsIGNoYW5nZXMgdGhlIHRleHQsIHdyYXBzIGl0IGluIGFcbiAgICogYG1lbnVtYWluLWxhYmVsYCBlbGVtZW50IGFuZCBwcmVwZW5kcyBpbnRlcm5hbGx5IHRoZSBnaXZlbiBhcHAgbG9nb1xuICAgKlxuICAgKiBAcGFyYW0ge29iamVjdH0gJG1lbnVJdGVtIFRoZSBjb250ZXh0IHdoZXJlIHRvIGZpbmQgdGhlIGxpbmtcbiAgICogQHBhcmFtIHtvYmplY3R9ICRhcHBMb2dvXG4gICAqIEByZXR1cm4gdGhlIGN1c3RvbWl6ZWQgaG9tZSBsaW5rXG4gICAqL1xuICBmdW5jdGlvbiBjdXN0b21pemVIb21lTGlua0luTG9nb01lbnVJdGVtICgkbWVudUl0ZW0sICRhcHBMb2dvKSB7XG4gICAgdmFyICRob21lTGluayA9ICQoJ2xpID4gYScsICRtZW51SXRlbSkuZmlyc3QoKTtcblxuICAgIHJldHVybiAkaG9tZUxpbmtcbiAgICAgIC50ZXh0KCdIb21lJylcbiAgICAgIC53cmFwSW5uZXIoJzxzcGFuIGNsYXNzPVwibWVudW1haW4tbGFiZWxcIj4nKVxuICAgICAgLnByZXBlbmQoJGFwcExvZ28pO1xuICB9XG5cbiAgLyoqXG4gICAqIEluamVjdHMgdGhlIGdpdmVuIG1hcmt1cCBpbiBhIG1lbnUgd3JhcHBlciB3aXRoIHRoZSBnaXZlbiBpZFxuICAgKiBjcmVhdGVkIHRvIGNvbnRhaW4gYm90aCB0aGUgb3JpZ2luYWwgbWVudSBhbmQgdGhlIHVzZXIgb25lXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBtZW51TWFya3VwXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB3cmFwcGVySWRcbiAgICovXG4gIGZ1bmN0aW9uIGluamVjdFVzZXJNZW51SW5BTWFpbk1lbnVXcmFwcGVyIChtZW51TWFya3VwLCB3cmFwcGVySWQpIHtcbiAgICB2YXIgJG1lbnVNYXJrdXAgPSAkKG1lbnVNYXJrdXApO1xuICAgIHZhciAkbWVudVdyYXBwZXIgPSAkKCc8ZGl2PicpO1xuXG4gICAgJG1lbnVXcmFwcGVyLmF0dHIoJ2lkJywgd3JhcHBlcklkKTtcbiAgICAkbWVudVdyYXBwZXIuYXBwZW5kKCQoJyNjaXZpY3JtLW1lbnUnKSk7XG4gICAgJG1lbnVXcmFwcGVyLmFwcGVuZCgkbWVudU1hcmt1cCk7XG4gICAgJG1lbnVXcmFwcGVyLmluc2VydEFmdGVyKCcjcGFnZScpO1xuICB9XG5cbiAgLyoqXG4gICAqIEluc2VydCBhIERPTSBub2RlIGFmdGVyIGlucHV0W3R5cGU9XCJmaWxlXCJdXG4gICAqIHdpdGggdGhlIGZpbGVuYW1lXG4gICAqL1xuICBmdW5jdGlvbiBpbnNlcnRGaWxlICgpIHtcbiAgICB2YXIgZmlsZU5hbWUgPSAkKHRoaXMpWzBdLmZpbGVzWzBdO1xuXG4gICAgJCgnI2pzLXVwbG9hZGVkLWZpbGUnKS5yZW1vdmUoKTtcbiAgICBpZiAoZmlsZU5hbWUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgJCh0aGlzKS5hZnRlcignPHNwYW4gaWQ9XCJqcy11cGxvYWRlZC1maWxlXCIgY2xhc3M9XCJ1cGxvYWRlZC1maWxlXCI+JyArIGZpbGVOYW1lLm5hbWUgKyAnIDxzcGFuIGNsYXNzPVwidXBsb2FkZWQtZmlsZS1pY29uLXRyYXNoXCI+PGkgY2xhc3M9XCJmYSBmYS10cmFzaC1vXCI+PC9pPiBSZW1vdmU8L3NwYW4+Jyk7XG5cbiAgICAgICQoJy51cGxvYWRlZC1maWxlLWljb24tdHJhc2gnKS5vbignY2xpY2snLCByZW1vdmVGaWxlKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlIGxhYmVsICdmb3InIGF0dHIgdG8gd29ya3Mgd2l0aCB0aGUgZGF0ZXBpY2tlclxuICAgKlxuICAgKiBAcGFyYW0gIHtqUXVlcnkgb2JqZWN0fSAkbGluZSBbZGF0ZXBpY2tlcidzIGxpbmUgcGFyZW50XVxuICAgKi9cbiAgZnVuY3Rpb24gbGlua0xhYmVsVG9EYXRlcGlja2VySW5wdXQgKCRsaW5lKSB7XG4gICAgJGxpbmUuZmluZCgnbGFiZWwnKS5hdHRyKCdmb3InLCAkbGluZS5maW5kKCcuY3JtLWZvcm0tZGF0ZScpLmF0dHIoJ2lkJykpO1xuICB9XG5cbiAgLyoqXG4gICAqIE1pc2MgY2hhbmdlcyB0byB0aGUgcGFnZSAoaGlkaW5nIGVsZW1lbnRzLCBpbnNlcnRpbmcgbmV3IG9uZXMsIGV0YylcbiAgICovXG4gIGZ1bmN0aW9uIG1pc2NDb250YWN0UGFnZUNoYW5nZXMgKHRhcmdldCkge1xuICAgIC8vIEhpZGUgY3VycmVudCBlbXBsb3llciBhbmQgam9iIHRpdGxlXG4gICAgLy8gQ29udGFjdCBzdW1tYXJ5IHNjcmVlbjpcbiAgICAkKCdkaXYuY3JtLWNvbnRhY3QtY3VycmVudF9lbXBsb3llciwgZGl2LmNybS1jb250YWN0LWpvYl90aXRsZScsICcuY3JtLXN1bW1hcnktY29udGFjdGluZm8tYmxvY2snKS5wYXJlbnQoJ2Rpdi5jcm0tc3VtbWFyeS1yb3cnKS5oaWRlKCk7XG4gICAgLy8gSW5saW5lIGVkaXQgZm9ybVxuICAgICQoJ2Zvcm0jQ29udGFjdEluZm8gaW5wdXQjZW1wbG95ZXJfaWQsIGZvcm0jQ29udGFjdEluZm8gaW5wdXQjam9iX3RpdGxlJywgdGFyZ2V0KS5jbG9zZXN0KCdkaXYuY3JtLXN1bW1hcnktcm93JykuaGlkZSgpO1xuICAgIC8vIENvbnRhY3QgZWRpdCBzY3JlZW5cbiAgICAkKCdpbnB1dCNlbXBsb3llcl9pZCwgaW5wdXQjam9iX3RpdGxlJywgJ2Zvcm0jQ29udGFjdCcpLnBhcmVudCgndGQnKS5oaWRlKCk7XG5cbiAgICAvKiBDaGFuZ2VzIG9uIEFkZCBJbmRpdmlkdWFsIHBhZ2VzIGFuZCBQZXJzb25hbCBkZXRhaWxzIHRhYiBmb3IgSFItMzU4ICovXG4gICAgLy8gTW92ZSBKb2Igc3VtbWFyeSB0byB0b3BcbiAgICAkKCcuSFJKb2JDb250cmFjdF9TdW1tYXJ5JywgdGFyZ2V0KS5pbnNlcnRCZWZvcmUoJCgnLmNybS1zdW1tYXJ5LWNvbnRhY3RpbmZvLWJsb2NrJykpO1xuICAgIC8vIGNoYW5nZXMgb2YgZW1haWwgYmxvY2ssIHJlbW92ZSBidWxrbWFpbCBhbmQgb25ob2xkXG4gICAgJCgnZGl2LmVtYWlsLXNpZ25hdHVyZSwgdGQjRW1haWwtQnVsa21haWwtaHRtbCcsICdmb3JtI0NvbnRhY3QnKS5oaWRlKCk7XG4gICAgJCgnI0VtYWlsLVByaW1hcnknLCAnZm9ybSNDb250YWN0JykucHJldigndGQnKS5wcmV2KCd0ZCcpLmhpZGUoKTtcbiAgICAkKCd0ZCNFbWFpbC1CdWxrbWFpbC1odG1sLCAjRW1haWwtUHJpbWFyeScsICdmb3JtI0NvbnRhY3QnKS5wcmV2KCd0ZCcpLmhpZGUoKTtcblxuICAgIC8vIHNoaWZ0IGRlbW9ncmFwaGljIGFib3ZlIGV4dGVuZGVkIGRlbW9ncmFwaGljXG4gICAgJCgnLmNybS1kZW1vZ3JhcGhpY3MtYWNjb3JkaW9uJywgJ2Zvcm0jQ29udGFjdCcpLmluc2VydEFmdGVyKCQoJy5jcm0tY29udGFjdERldGFpbHMtYWNjb3JkaW9uJykpO1xuXG4gICAgaWYgKCQoJ3RyI1Bob25lX0Jsb2NrXzInLCAnZm9ybSNDb250YWN0JykubGVuZ3RoIDwgMSkge1xuICAgICAgJCgnI2FkZFBob25lJykuY2xpY2soKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmVtb3ZlIHRoZSAjanMtdXBsb2FkZWQtZmlsZSBESVYgYW5kXG4gICAqIGNsZWFuIGlucHV0W3R5cGU9XCJmaWxlXCJdIHZhbHVlXG4gICAqL1xuICBmdW5jdGlvbiByZW1vdmVGaWxlICgpIHtcbiAgICB2YXIgJGlucHV0ID0gJCgnI2pzLXVwbG9hZGVkLWZpbGUnKS5wYXJlbnQoKS5maW5kKCdpbnB1dFt0eXBlPVwiZmlsZVwiXScpO1xuXG4gICAgJCgnI2pzLXVwbG9hZGVkLWZpbGUnKS5yZW1vdmUoKTtcbiAgICAkaW5wdXQudmFsKCcnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBNb3ZlcyB0aGUgZ2l2ZW4gaG9tZSBsaW5rIHJpZ2h0IHVuZGVyIHRoZSBtZW51IGl0ZW0gYW5kIGdldHMgcmlkXG4gICAqIG9mIHRoZSBvcmlnaW5hbCBzdWIgbWVudVxuICAgKlxuICAgKiBAcGFyYW0ge29iamVjdH0gJG1lbnVJdGVtIFRoZSBjb250ZXh0IHdoZXJlIHRvIGZpbmQgdGhlIGxpbmtcbiAgICogQHBhcmFtIHtvYmplY3R9ICRob21lTGlua1xuICAgKi9cbiAgZnVuY3Rpb24gcmVtb3ZlTG9nb1N1Yk1lbnVBbmRLZWVwT25seUhvbWVMaW5rICgkbWVudUl0ZW0sICRob21lTGluaykge1xuICAgICRtZW51SXRlbVxuICAgICAgLm9mZigpIC8vIHJlbW92ZXMgYW55IGhhbmRsZXIgdGhhdCB0aGUgb3JpZ2luYWwgaXRlbSBoYWRcbiAgICAgIC5maW5kKCcjY2l2aWNybS1ob21lJylcbiAgICAgIC5iZWZvcmUoJGhvbWVMaW5rKVxuICAgICAgLnJlbW92ZSgpO1xuICB9XG5cbiAgLyoqXG4gICAqIFN3YXBzIHRoZSBDaXZpQ1JNIGxvZ28gd2l0aCB0aGUgQ2l2aUhSIGxvZ29cbiAgICogYW5kIHdyYXBzIGl0IGluIGEgYG1lbnVtYWluLWljb25gIGVsZW1lbnRcbiAgICpcbiAgICogQHBhcmFtIHtvYmplY3R9ICRtZW51SXRlbSBUaGUgY29udGV4dCB3aGVyZSB0byBmaW5kIHRoZSBsb2dvXG4gICAqIEByZXR1cm4gdGhlIHdyYXBwZXIgb2YgdGhlIGxvZ29cbiAgICovXG4gIGZ1bmN0aW9uIHN3YXBBbmRXcmFwQXBwTG9nbyAoJG1lbnVJdGVtKSB7XG4gICAgdmFyICRhcHBMb2dvID0gJCgnLmNybS1sb2dvLXNtJywgJG1lbnVJdGVtKTtcblxuICAgIHJldHVybiAkYXBwTG9nb1xuICAgICAgLmFkZENsYXNzKCdjaHJfbG9nbyBjaHJfbG9nby0tZGVmYXVsdC1jb2xvcicpXG4gICAgICAucmVtb3ZlQ2xhc3MoJ2NybS1sb2dvLXNtJylcbiAgICAgIC53cmFwKCc8c3BhbiBjbGFzcz1cIm1lbnVtYWluLWljb25cIj4nKVxuICAgICAgLnBhcmVudCgpO1xuICB9XG5cbiAgLyoqXG4gICAqIENpdmlDUk0gYnkgZGVmYXVsdCBhcHBsaWVzIG9uIGhvdmVyIHRoZSAuYWN0aXZldGFyZ2V0IGNsYXNzXG4gICAqIG9ubHkgdG8gbWFpbiBtZW51IGl0ZW1zIHdpdGggYSBzdWJtZW51XG4gICAqXG4gICAqIFRoaXMgZnVuY3Rpb25zIG1ha2VzIHN1cmUgdGhhdCBhbnkgaXRlbSBnZXRzIHRoZSBjbGFzcyBhcHBsaWVkLFxuICAgKiBldmVuIHRob3NlIHdpdGgganVzdCBhIGRpcmVjdCBsaW5rXG4gICAqL1xuICBmdW5jdGlvbiB0b2dnbGVBY3RpdmVDbGFzc09uSG92ZXJPbkFueU1haW5NZW51SXRlbSAoKSB7XG4gICAgdmFyIGNsYXNzTmFtZSA9ICdhY3RpdmV0YXJnZXQnO1xuXG4gICAgJCgnLm1lbnVtYWluJykubm90KCcuY3JtLVNlbGZfU2VydmljZV9Qb3J0YWwnKS5ob3ZlcihmdW5jdGlvbiAoKSB7XG4gICAgICAkKHRoaXMpLmFkZENsYXNzKGNsYXNzTmFtZSk7XG4gICAgfSwgZnVuY3Rpb24gKCkge1xuICAgICAgJCh0aGlzKS5yZW1vdmVDbGFzcyhjbGFzc05hbWUpO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZSB0aGUgYXJyb3cgZm9yIG1lbnUgaXRlbXMgd2l0aCBzdWItaXRlbXMsIGFuZCByZXBsYWNlcyBpdFxuICAgKiB3aXRoIGEgZm9udCBhd2Vzb21lIGNhcmV0XG4gICAqL1xuICBmdW5jdGlvbiB1c2VGb250QXdlc29tZUFycm93c0luU3ViTWVudUl0ZW1zICgpIHtcbiAgICAkKCcjcm9vdC1tZW51LWRpdiAubWVudS1pdGVtLWFycm93JykuZWFjaChmdW5jdGlvbiAoJGVsZW1lbnQpIHtcbiAgICAgIHZhciAkYXJyb3cgPSAkKHRoaXMpO1xuXG4gICAgICAkYXJyb3cuYmVmb3JlKCc8aSBjbGFzcz1cImZhIGZhLWNhcmV0LXJpZ2h0IG1lbnUtaXRlbS1hcnJvd1wiPjwvaT4nKTtcbiAgICAgICRhcnJvdy5yZW1vdmUoKTtcbiAgICB9KTtcbiAgfVxufShDUk0uJCwgQ1JNLl8pKTtcbiIsIihmdW5jdGlvbiAoJCkge1xuICAndXNlIHN0cmljdCc7XG4gIHZhciBNdXRhdGlvbk9ic2VydmVyID0gd2luZG93Lk11dGF0aW9uT2JzZXJ2ZXIgfHwgd2luZG93LldlYktpdE11dGF0aW9uT2JzZXJ2ZXIgfHwgd2luZG93Lk1vek11dGF0aW9uT2JzZXJ2ZXI7XG5cbiAgLypcbiAgVGhpcyBwbHVnaW4gY3JlYXRlcyBNdXRhdGlvbk9ic2VydmVyIHdoaWNoIGxpc3RlbnMgdG8gYWxsIGNoYW5nZXMgdG8gRE9NIE5vZGUuXG4gIElmIGNoYW5nZSBoYXMgYmVlbiBkb25lIHRvIGl0J3MgYXR0cmlidXRlcyBjYWxsYmFjayB3aWxsIGJlIGNhbGxlZC5cblxuICBAcGFyYW0ge2Z1bmN0aW9ufSBjYWxsYmFjayAtIHRvIGJlIGNhbGxlZCB3aGVuIGF0dHJpYnV0ZXMgY2hhbmdlXG4gIEByZXR1cm5zIHtBcnJheX0gLSBsaXN0IG9mIGFsbCBvYnNlcnZlZCBlbGVtZW50c1xuICAqL1xuICAkLmZuLmF0dHJjaGFuZ2UgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICBpZiAoTXV0YXRpb25PYnNlcnZlcikge1xuICAgICAgdmFyIG9wdGlvbnMgPSB7XG4gICAgICAgIHN1YnRyZWU6IGZhbHNlLFxuICAgICAgICBhdHRyaWJ1dGVzOiB0cnVlXG4gICAgICB9O1xuXG4gICAgICB2YXIgb2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcihmdW5jdGlvbiAobXV0YXRpb25zKSB7XG4gICAgICAgIG11dGF0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgY2FsbGJhY2suY2FsbChlLnRhcmdldCwgZSk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICBvYnNlcnZlci5vYnNlcnZlKHRoaXMsIG9wdGlvbnMpO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG59KShDUk0uJCk7XG4iLCIvKiBnbG9iYWxzIENSTSAqL1xuXG4vKlxuUHJldmVudCBQb3B1cHMgdG8gb3ZlcmZsb3cgdGFibGVzLlxuKi9cbihmdW5jdGlvbiAoJCkge1xuICAndXNlIHN0cmljdCc7XG4gIHZhciAkYm9keSA9ICQoJ2JvZHknKTtcblxuICAkYm9keS5vbignY2xpY2snLCAnLmJ0bi1zbGlkZScsIGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgJGJ1dHRvbiA9ICQodGhpcyk7XG4gICAgdmFyICRjbG9zZXN0RW50aXR5ID0gJGJ1dHRvbi5jbG9zZXN0KCcuY3JtLWVudGl0eScpWzBdO1xuICAgIHZhciAkcG9wdXAgPSAkYnV0dG9uLmNoaWxkcmVuKCd1bC5wYW5lbCcpO1xuXG4gICAgKGZ1bmN0aW9uIGluaXQgKCkge1xuICAgICAgb3BlblBvcHVwUGFuZWwoKTtcbiAgICAgIGxpc3RlblRvTW91c2VPdXRFdmVudCgpO1xuICAgIH0pKCk7XG5cbiAgICAvKipcbiAgICAgKiBDbG9zZXMgdGhlIGFueSBwb3B1cCBwYW5lbCB0aGF0IGlzIGN1cnJlbnRseSBvcGVuIGFuZCByZW1vdmVzIHRoZVxuICAgICAqIGAuY2l2aWhyLXBvcHVwLW9wZW5gIGNsYXNzIGZyb20gdGhlIGJvZHkuXG4gICAgICovXG4gICAgZnVuY3Rpb24gY2xvc2VQb3B1cFBhbmVscyAoKSB7XG4gICAgICAkKCcuY2l2aWhyLXBvcHVwJykucmVtb3ZlKCk7XG4gICAgICAkYm9keS5yZW1vdmVDbGFzcygnY2l2aWhyLXBvcHVwLW9wZW4nKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgY2xvbmUgb2YgdGhlIHBvcHVwIGVsZW1lbnQgYW5kIGFwcGVuZHMgaXQgdG8gdGhlIGRvY3VtZW50IGJvZHkuXG4gICAgICogVGhpcyBwcmV2ZW50cyB0aGUgcG9wdXAgdG8gYmUgaGlkZGVuIGJ5IGFueSBgb3ZlcmZsb3c6IGhpZGRlbjtgIHJ1bGUuXG4gICAgICovXG4gICAgZnVuY3Rpb24gY3JlYXRlUG9wdXBDbG9uZSAoKSB7XG4gICAgICB2YXIgYnV0dG9uT2Zmc2V0ID0gJGJ1dHRvbi5vZmZzZXQoKTtcbiAgICAgIHZhciAkY2xvbmUgPSAkcG9wdXAuY2xvbmUodHJ1ZSlcbiAgICAgICAgLmFwcGVuZFRvKCRib2R5KVxuICAgICAgICAuYWRkQ2xhc3MoJ2Npdmloci1wb3B1cCcpXG4gICAgICAgIC5hdHRyKCdpZCcsICRjbG9zZXN0RW50aXR5LmlkKVxuICAgICAgICAuYWRkQ2xhc3MoJCgkY2xvc2VzdEVudGl0eSkuYXR0cignY2xhc3MnKSk7XG5cbiAgICAgICRjbG9uZS5jc3Moe1xuICAgICAgICBsZWZ0OiArYnV0dG9uT2Zmc2V0LmxlZnQgLSAoJGNsb25lLndpZHRoKCkgLSAkYnV0dG9uLm91dGVyV2lkdGgoKSksXG4gICAgICAgIHRvcDogK2J1dHRvbk9mZnNldC50b3AgKyAkYnV0dG9uLm91dGVySGVpZ2h0KClcbiAgICAgIH0pO1xuICAgICAgJGNsb25lLnNob3coKTtcbiAgICAgIG1hcENsb25lQ2xpY2tFdmVudHNUb09yaWdpbigkY2xvbmUpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIExpc3RlbnMgdG8gbW91c2UgZXZlbnRzIGhhcHBlbmluZyBvdXRzaWRlIHRoZSBvZiB0aGUgcGFuZWwgaW4gb3JkZXIgdG9cbiAgICAgKiBjbG9zZSBpdC4gVGhlIHdheSB0byBkZXRlY3RlZCBtb3VzZSBvdXQgaXMgYnkgbGlzdGVuaW5nIHRvIHRoZVxuICAgICAqIC5idG4tc2xpZGUtYWN0aXZlIGNsYXNzIGNoYW5nZSwgd2hpY2ggaXMgYWRkZWQgYW5kIHJlbW92ZWQgYnkgQ2l2aUNSTS5cbiAgICAgKiB0aGUgZGF0YSAqYXR0cmNoYW5nZS1pcy1vbiogaXMgc2V0IHRvIHRydWUgaW4gb3JkZXIgdG8gYXZvaWQgYWRkaW5nXG4gICAgICogbXVsdGlwbGUgbGlzdGVuZXJzIHRvIHRoZSBzYW1lIGVsZW1lbnQuXG4gICAgICovXG4gICAgZnVuY3Rpb24gbGlzdGVuVG9Nb3VzZU91dEV2ZW50ICgpIHtcbiAgICAgIC8vIElmIEF0dHJDaGFuZ2UgZXZlbnQgaXMgYWxyZWFkeSBsaXN0ZW5lZCwgdGhlbiBza2lwOlxuICAgICAgaWYgKCRidXR0b24uZGF0YSgnYXR0cmNoYW5nZS1pcy1vbicpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgJGJ1dHRvbi5kYXRhKCdhdHRyY2hhbmdlLWlzLW9uJywgdHJ1ZSk7XG4gICAgICAkYnV0dG9uLmF0dHJjaGFuZ2UoZnVuY3Rpb24gKCkge1xuICAgICAgICAvLyBJZiBidXR0b24gaXMgYWxyZWFkeSBvcGVuLCB0aGVuIHNraXA6XG4gICAgICAgIGlmICgkYnV0dG9uLmhhc0NsYXNzKCdidG4tc2xpZGUtYWN0aXZlJykpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjbG9zZVBvcHVwUGFuZWxzKCk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBNYXBzIGNsaWNrIGV2ZW50cyBvbiB0aGUgcG9wdXAgb3B0aW9ucyBiYWNrIHRvIHRoZWlyIG9yaWdpbmFsIHNvdXJjZS5cbiAgICAgKiBUaGlzIGlzIGRvbmUgYmVjYXVzZSBwb3B1cCBhY3Rpb25zIGFyZSBleGVjdXRlZCBhcyBkZWxlZ2F0ZWQgZXZlbnRzIGFuZFxuICAgICAqIHRoZSBsaXN0ZW5lciBpcyBub3QgdGhlICpib2R5KiBlbGVtZW50LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtPYmplY3R9ICRjbG9uZSAtIFRoZSBqUXVlcnkgY2xvbmUgZWxlbWVudCB0byBtYXBcbiAgICAgKiBjbGljayBldmVudHMgZnJvbS5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBtYXBDbG9uZUNsaWNrRXZlbnRzVG9PcmlnaW4gKCRjbG9uZSkge1xuICAgICAgJGNsb25lLmZpbmQoJ2EnKS5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBhY3Rpb25JbmRleCA9ICQodGhpcykucGFyZW50KCkuaW5kZXgoKTtcblxuICAgICAgICAkcG9wdXAuZmluZCgnbGk6bnRoKCcgKyBhY3Rpb25JbmRleCArICcpIGEnKS5jbGljaygpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogT3BlbnMgdGhlIHBvcHVwIHBhbmVsXG4gICAgICogYW5kIGFkZHMgdGhlIC5jaXZpaHItcG9wdXAtb3BlbiBjbGFzcyB0byB0aGUgYm9keVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIG9wZW5Qb3B1cFBhbmVsICgpIHtcbiAgICAgIGNsb3NlUG9wdXBQYW5lbHMoKTtcbiAgICAgIGNyZWF0ZVBvcHVwQ2xvbmUoKTtcbiAgICAgICRib2R5LmFkZENsYXNzKCdjaXZpaHItcG9wdXAtb3BlbicpO1xuICAgIH1cbiAgfSk7XG59KShDUk0uJCk7XG4iXX0=
